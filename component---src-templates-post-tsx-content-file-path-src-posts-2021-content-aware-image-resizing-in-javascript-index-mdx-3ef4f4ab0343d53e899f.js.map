{"version":3,"file":"component---src-templates-post-tsx-content-file-path-src-posts-2021-content-aware-image-resizing-in-javascript-index-mdx-3ef4f4ab0343d53e899f.js","mappings":"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","sources":["webpack://trekhleb.github.io/./node_modules/@react-icons/all-files/bi/BiErrorCircle.js","webpack://trekhleb.github.io/./node_modules/@react-icons/all-files/bs/BsFillInfoCircleFill.js","webpack://trekhleb.github.io/./node_modules/@react-icons/all-files/fa/FaFileImage.js","webpack://trekhleb.github.io/./node_modules/@react-icons/all-files/fa/FaRegHandPointer.js","webpack://trekhleb.github.io/./node_modules/@react-icons/all-files/fi/FiCalendar.js","webpack://trekhleb.github.io/./node_modules/@react-icons/all-files/fi/FiClock.js","webpack://trekhleb.github.io/./node_modules/@react-icons/all-files/im/ImShrink2.js","webpack://trekhleb.github.io/./node_modules/@react-icons/all-files/md/MdLayersClear.js","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/components/imageUtils.ts","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/components/contentAwareResizer.ts","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/components/EnergyMap.tsx","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/components/Seams.tsx","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/assets/02.jpg","webpack://trekhleb.github.io/./src/components/shared/Button.tsx","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/components/FileSelector.tsx","webpack://trekhleb.github.io/./src/components/shared/Checkbox.tsx","webpack://trekhleb.github.io/./src/components/shared/Progress.tsx","webpack://trekhleb.github.io/./src/components/shared/Input.tsx","webpack://trekhleb.github.io/./src/components/shared/FadeIn.tsx","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/components/Mask.tsx","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/components/ImageResizer.tsx","webpack://trekhleb.github.io/./src/posts/2021/content-aware-image-resizing-in-javascript/index.mdx","webpack://trekhleb.github.io/./src/templates/Post.tsx","webpack://trekhleb.github.io/./src/components/elements/Post.tsx","webpack://trekhleb.github.io/./src/components/screens/PostScreen.tsx","webpack://trekhleb.github.io/./src/components/shared/Alert.tsx","webpack://trekhleb.github.io/./src/components/shared/ErrorBoundary.tsx","webpack://trekhleb.github.io/./src/components/shared/InteractivePostArea.tsx","webpack://trekhleb.github.io/./src/components/shared/PageHeader.tsx","webpack://trekhleb.github.io/./src/components/shared/SubscriptionForm.tsx","webpack://trekhleb.github.io/./src/utils/time.ts","webpack://trekhleb.github.io/./node_modules/@mdx-js/react/lib/index.js"],"sourcesContent":["// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.BiErrorCircle = function BiErrorCircle (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M11.953,2C6.465,2,2,6.486,2,12s4.486,10,10,10s10-4.486,10-10S17.493,2,11.953,2z M12,20c-4.411,0-8-3.589-8-8 s3.567-8,7.953-8C16.391,4,20,7.589,20,12S16.411,20,12,20z\"}},{\"tag\":\"path\",\"attr\":{\"d\":\"M11 7H13V14H11zM11 15H13V17H11z\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.BsFillInfoCircleFill = function BsFillInfoCircleFill (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 16 16\",\"fill\":\"currentColor\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"fillRule\":\"evenodd\",\"d\":\"M8 16A8 8 0 108 0a8 8 0 000 16zm.93-9.412l-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM8 5.5a1 1 0 100-2 1 1 0 000 2z\",\"clipRule\":\"evenodd\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.FaFileImage = function FaFileImage (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 384 512\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M384 121.941V128H256V0h6.059a24 24 0 0 1 16.97 7.029l97.941 97.941a24.002 24.002 0 0 1 7.03 16.971zM248 160c-13.2 0-24-10.8-24-24V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248zm-135.455 16c26.51 0 48 21.49 48 48s-21.49 48-48 48-48-21.49-48-48 21.491-48 48-48zm208 240h-256l.485-48.485L104.545 328c4.686-4.686 11.799-4.201 16.485.485L160.545 368 264.06 264.485c4.686-4.686 12.284-4.686 16.971 0L320.545 304v112z\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.FaRegHandPointer = function FaRegHandPointer (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 448 512\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M358.182 179.361c-19.493-24.768-52.679-31.945-79.872-19.098-15.127-15.687-36.182-22.487-56.595-19.629V67c0-36.944-29.736-67-66.286-67S89.143 30.056 89.143 67v161.129c-19.909-7.41-43.272-5.094-62.083 8.872-29.355 21.795-35.793 63.333-14.55 93.152l109.699 154.001C134.632 501.59 154.741 512 176 512h178.286c30.802 0 57.574-21.5 64.557-51.797l27.429-118.999A67.873 67.873 0 0 0 448 326v-84c0-46.844-46.625-79.273-89.818-62.639zM80.985 279.697l27.126 38.079c8.995 12.626 29.031 6.287 29.031-9.283V67c0-25.12 36.571-25.16 36.571 0v175c0 8.836 7.163 16 16 16h6.857c8.837 0 16-7.164 16-16v-35c0-25.12 36.571-25.16 36.571 0v35c0 8.836 7.163 16 16 16H272c8.837 0 16-7.164 16-16v-21c0-25.12 36.571-25.16 36.571 0v21c0 8.836 7.163 16 16 16h6.857c8.837 0 16-7.164 16-16 0-25.121 36.571-25.16 36.571 0v84c0 1.488-.169 2.977-.502 4.423l-27.43 119.001c-1.978 8.582-9.29 14.576-17.782 14.576H176c-5.769 0-11.263-2.878-14.697-7.697l-109.712-154c-14.406-20.223 14.994-42.818 29.394-22.606zM176.143 400v-96c0-8.837 6.268-16 14-16h6c7.732 0 14 7.163 14 16v96c0 8.837-6.268 16-14 16h-6c-7.733 0-14-7.163-14-16zm75.428 0v-96c0-8.837 6.268-16 14-16h6c7.732 0 14 7.163 14 16v96c0 8.837-6.268 16-14 16h-6c-7.732 0-14-7.163-14-16zM327 400v-96c0-8.837 6.268-16 14-16h6c7.732 0 14 7.163 14 16v96c0 8.837-6.268 16-14 16h-6c-7.732 0-14-7.163-14-16z\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.FiCalendar = function FiCalendar (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":\"2\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"},\"child\":[{\"tag\":\"rect\",\"attr\":{\"x\":\"3\",\"y\":\"4\",\"width\":\"18\",\"height\":\"18\",\"rx\":\"2\",\"ry\":\"2\"}},{\"tag\":\"line\",\"attr\":{\"x1\":\"16\",\"y1\":\"2\",\"x2\":\"16\",\"y2\":\"6\"}},{\"tag\":\"line\",\"attr\":{\"x1\":\"8\",\"y1\":\"2\",\"x2\":\"8\",\"y2\":\"6\"}},{\"tag\":\"line\",\"attr\":{\"x1\":\"3\",\"y1\":\"10\",\"x2\":\"21\",\"y2\":\"10\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.FiClock = function FiClock (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":\"2\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"},\"child\":[{\"tag\":\"circle\",\"attr\":{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}},{\"tag\":\"polyline\",\"attr\":{\"points\":\"12 6 12 12 16 14\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.ImShrink2 = function ImShrink2 (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"version\":\"1.1\",\"viewBox\":\"0 0 16 16\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M7 9v6.5l-2.5-2.5-3 3-1.5-1.5 3-3-2.5-2.5zM16 1.5l-3 3 2.5 2.5h-6.5v-6.5l2.5 2.5 3-3z\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.MdLayersClear = function MdLayersClear (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M19.81 14.99l1.19-.92-1.43-1.43-1.19.92 1.43 1.43zm-.45-4.72L21 9l-9-7-2.91 2.27 7.87 7.88 2.4-1.88zM3.27 1L2 2.27l4.22 4.22L3 9l1.63 1.27L12 16l2.1-1.63 1.43 1.43L12 18.54l-7.37-5.73L3 14.07l9 7 4.95-3.85L20.73 21 22 19.73 3.27 1z\"}}]})(props);\n};\n","// Type that describes the image pixel's RGBA color.\nexport type Color = [\n  r: number, // Red\n  g: number, // Green\n  b: number, // Blue\n  a: number, // Alpha (transparency)\n] | Uint8ClampedArray;\n\n// The coordinate of the pixel.\nexport type Coordinate = { x: number, y: number };\n\n// Helper function that returns the color of the pixel.\nexport const getPixel = (img: ImageData, { x, y }: Coordinate): Color => {\n  // The ImageData data array is a flat 1D array.\n  // Thus we need to convert x and y coordinates to the linear index.\n  const i = y * img.width + x;\n  const cellsPerColor = 4; // RGBA\n  // For better efficiency, instead of creating a new sub-array we return\n  // a pointer to the part of the ImageData array.\n  return img.data.subarray(i * cellsPerColor, i * cellsPerColor + cellsPerColor);\n};\n\n// Helper function that sets the color of the pixel.\nexport const setPixel = (img: ImageData, { x, y }: Coordinate, color: Color): void => {\n  // The ImageData data array is a flat 1D array.\n  // Thus we need to convert x and y coordinates to the linear index.\n  const i = y * img.width + x;\n  const cellsPerColor = 4; // RGBA\n  img.data.set(color, i * cellsPerColor);\n};\n","/* eslint-disable no-await-in-loop, no-param-reassign, object-curly-newline */\nimport {\n  Color,\n  Coordinate,\n  getPixel,\n  setPixel,\n} from './imageUtils';\nimport { wait } from '../../../../utils/time';\n\nexport type Seam = Coordinate[];\nexport type EnergyMap = number[][];\n\ntype SeamMeta = {\n  energy: number,\n  coordinate: Coordinate,\n  previous: Coordinate | null,\n};\n\nexport type ImageSize = { w: number, h: number };\n\nexport type OnIterationArgs = {\n  seam: Seam,\n  img: ImageData,\n  size: ImageSize,\n  energyMap: EnergyMap,\n  step: number,\n  steps: number,\n};\n\n// If pixel's alpha is lower than the threshold this pixel is going to have\n// the lowest energy and thus is a candidate for deletion.\nexport const ALPHA_DELETE_THRESHOLD = 244;\n\nexport const MAX_WIDTH_LIMIT = 1500;\nexport const MAX_HEIGHT_LIMIT = 1500;\n\nconst getPixelDeleteEnergy = (): number => {\n  const numColors = 3;\n  const maxColorDistance = 255;\n  const numNeighbors = 2;\n  const multiplier = 2;\n  const maxSeamSize = Math.max(MAX_WIDTH_LIMIT, MAX_HEIGHT_LIMIT);\n  return -1 * multiplier * numNeighbors * maxSeamSize * numColors * (maxColorDistance ** 2);\n};\n\nconst matrix = <T>(w: number, h: number, filler: T): T[][] => {\n  return new Array(h)\n    .fill(null)\n    .map(() => {\n      return new Array(w).fill(filler);\n    });\n};\n\nconst getPixelEnergy = (left: Color | null, middle: Color, right: Color | null): number => {\n  const [mR, mG, mB, mA] = middle;\n\n  let lEnergy = 0;\n  if (left) {\n    const [lR, lG, lB] = left;\n    lEnergy = (lR - mR) ** 2 + (lG - mG) ** 2 + (lB - mB) ** 2;\n  }\n\n  let rEnergy = 0;\n  if (right) {\n    const [rR, rG, rB] = right;\n    rEnergy = (rR - mR) ** 2 + (rG - mG) ** 2 + (rB - mB) ** 2;\n  }\n\n  return mA > ALPHA_DELETE_THRESHOLD ? Math.sqrt(lEnergy + rEnergy) : getPixelDeleteEnergy();\n};\n\nconst getPixelEnergyH = (img: ImageData, { w }: ImageSize, { x, y }: Coordinate): number => {\n  const left = (x - 1) >= 0 ? getPixel(img, { x: x - 1, y }) : null;\n  const middle = getPixel(img, { x, y });\n  const right = (x + 1) < w ? getPixel(img, { x: x + 1, y }) : null;\n  return getPixelEnergy(left, middle, right);\n};\n\nconst getPixelEnergyV = (img: ImageData, { h }: ImageSize, { x, y }: Coordinate): number => {\n  const top = (y - 1) >= 0 ? getPixel(img, { x, y: y - 1 }) : null;\n  const middle = getPixel(img, { x, y });\n  const bottom = (y + 1) < h ? getPixel(img, { x, y: y + 1 }) : null;\n  return getPixelEnergy(top, middle, bottom);\n};\n\nconst calculateEnergyMapH = (img: ImageData, { w, h }: ImageSize): EnergyMap => {\n  const energyMap: number[][] = matrix<number>(w, h, Infinity);\n  for (let y = 0; y < h; y += 1) {\n    for (let x = 0; x < w; x += 1) {\n      energyMap[y][x] = getPixelEnergyH(img, { w, h }, { x, y });\n    }\n  }\n  return energyMap;\n};\n\nconst calculateEnergyMapV = (img: ImageData, { w, h }: ImageSize): EnergyMap => {\n  const energyMap: number[][] = matrix<number>(w, h, Infinity);\n  for (let y = 0; y < h; y += 1) {\n    for (let x = 0; x < w; x += 1) {\n      energyMap[y][x] = getPixelEnergyV(img, { w, h }, { x, y });\n    }\n  }\n  return energyMap;\n};\n\nconst reCalculateEnergyMapH = (\n  img: ImageData,\n  { w, h }: ImageSize,\n  energyMap: EnergyMap,\n  seam: Seam,\n): EnergyMap => {\n  seam.forEach(({ x: seamX, y: seamY }: Coordinate) => {\n    // Deleting the seam from the energy map.\n    for (let x = seamX; x < (w - 1); x += 1) {\n      energyMap[seamY][x] = energyMap[seamY][x + 1];\n    }\n    // Recalculating the energy pixels around the deleted seam.\n    energyMap[seamY][seamX] = getPixelEnergyH(img, { w, h }, { x: seamX, y: seamY });\n  });\n  return energyMap;\n};\n\nconst reCalculateEnergyMapV = (\n  img: ImageData,\n  { w, h }: ImageSize,\n  energyMap: EnergyMap,\n  seam: Seam,\n): EnergyMap => {\n  seam.forEach(({ x: seamX, y: seamY }: Coordinate) => {\n    // Deleting the seam from the energy map.\n    for (let y = seamY; y < (h - 1); y += 1) {\n      energyMap[y][seamX] = energyMap[y + 1][seamX];\n    }\n    // Recalculating the energy pixels around the deleted seam.\n    energyMap[seamY][seamX] = getPixelEnergyV(img, { w, h }, { x: seamX, y: seamY });\n  });\n  return energyMap;\n};\n\nconst findLowEnergySeamH = (energyMap: EnergyMap, { w, h }: ImageSize): Seam => {\n  const seamsMap: (SeamMeta | null)[][] = matrix<SeamMeta | null>(w, h, null);\n\n  // Populate the first row of the map.\n  for (let x = 0; x < w; x += 1) {\n    const y = 0;\n    seamsMap[y][x] = {\n      energy: energyMap[y][x],\n      coordinate: { x, y },\n      previous: null,\n    };\n  }\n\n  // Populate the rest of the rows.\n  for (let y = 1; y < h; y += 1) {\n    for (let x = 0; x < w; x += 1) {\n      // Find top adjacent cell with minimum energy.\n      let minPrevEnergy = Infinity;\n      let minPrevX: number = x;\n      for (let i = (x - 1); i <= (x + 1); i += 1) {\n        // @ts-ignore\n        if (i >= 0 && i < w && seamsMap[y - 1][i].energy < minPrevEnergy) {\n          // @ts-ignore\n          minPrevEnergy = seamsMap[y - 1][i].energy;\n          minPrevX = i;\n        }\n      }\n\n      // Update the current cell.\n      seamsMap[y][x] = {\n        energy: minPrevEnergy + energyMap[y][x],\n        coordinate: { x, y },\n        previous: { x: minPrevX, y: y - 1 },\n      };\n    }\n  }\n\n  // Find where the minimum energy seam ends.\n  let lastMinCoordinate: Coordinate | null = null;\n  let minSeamEnergy = Infinity;\n  for (let x = 0; x < w; x += 1) {\n    const y = h - 1;\n    // @ts-ignore\n    if (seamsMap[y][x].energy < minSeamEnergy) {\n      // @ts-ignore\n      minSeamEnergy = seamsMap[y][x].energy;\n      lastMinCoordinate = { x, y };\n    }\n  }\n\n  // Find the minimal energy seam.\n  const seam: Seam = [];\n  if (!lastMinCoordinate) {\n    return seam;\n  }\n\n  const { x: lastMinX, y: lastMinY } = lastMinCoordinate;\n\n  let currentSeam = seamsMap[lastMinY][lastMinX];\n  while (currentSeam) {\n    seam.push(currentSeam.coordinate);\n    const prevMinCoordinates = currentSeam.previous;\n    if (!prevMinCoordinates) {\n      currentSeam = null;\n    } else {\n      const { x: prevMinX, y: prevMinY } = prevMinCoordinates;\n      currentSeam = seamsMap[prevMinY][prevMinX];\n    }\n  }\n\n  return seam;\n};\n\nconst findLowEnergySeamV = (energyMap: EnergyMap, { w, h }: ImageSize): Seam => {\n  const seamsMap: (SeamMeta | null)[][] = matrix<SeamMeta | null>(w, h, null);\n\n  // Populate the first column of the map.\n  for (let y = 0; y < h; y += 1) {\n    const x = 0;\n    seamsMap[y][x] = {\n      energy: energyMap[y][x],\n      coordinate: { x, y },\n      previous: null,\n    };\n  }\n\n  // Populate the rest of the columns.\n  for (let x = 1; x < w; x += 1) {\n    for (let y = 0; y < h; y += 1) {\n      // Find left adjacent cell with minimum energy.\n      let minPrevEnergy = Infinity;\n      let minPrevY: number = y;\n      for (let i = (y - 1); i <= (y + 1); i += 1) {\n        // @ts-ignore\n        if (i >= 0 && i < h && seamsMap[i][x - 1].energy < minPrevEnergy) {\n          // @ts-ignore\n          minPrevEnergy = seamsMap[i][x - 1].energy;\n          minPrevY = i;\n        }\n      }\n\n      // Update the current cell.\n      seamsMap[y][x] = {\n        energy: minPrevEnergy + energyMap[y][x],\n        coordinate: { x, y },\n        previous: { x: x - 1, y: minPrevY },\n      };\n    }\n  }\n\n  // Find where the minimum energy seam ends.\n  let lastMinCoordinate: Coordinate | null = null;\n  let minSeamEnergy = Infinity;\n  for (let y = 0; y < h; y += 1) {\n    const x = w - 1;\n    // @ts-ignore\n    if (seamsMap[y][x].energy < minSeamEnergy) {\n      // @ts-ignore\n      minSeamEnergy = seamsMap[y][x].energy;\n      lastMinCoordinate = { x, y };\n    }\n  }\n\n  // Find the minimal energy seam.\n  const seam: Seam = [];\n  if (!lastMinCoordinate) {\n    return seam;\n  }\n\n  const { x: lastMinX, y: lastMinY } = lastMinCoordinate;\n\n  let currentSeam = seamsMap[lastMinY][lastMinX];\n  while (currentSeam) {\n    seam.push(currentSeam.coordinate);\n    const prevMinCoordinates = currentSeam.previous;\n    if (!prevMinCoordinates) {\n      currentSeam = null;\n    } else {\n      const { x: prevMinX, y: prevMinY } = prevMinCoordinates;\n      currentSeam = seamsMap[prevMinY][prevMinX];\n    }\n  }\n\n  return seam;\n};\n\nconst deleteSeamH = (img: ImageData, seam: Seam, { w }: ImageSize): void => {\n  seam.forEach(({ x: seamX, y: seamY }: Coordinate) => {\n    for (let x = seamX; x < (w - 1); x += 1) {\n      const nextPixel = getPixel(img, { x: x + 1, y: seamY });\n      setPixel(img, { x, y: seamY }, nextPixel);\n    }\n  });\n};\n\nconst deleteSeamV = (img: ImageData, seam: Seam, { h }: ImageSize): void => {\n  seam.forEach(({ x: seamX, y: seamY }: Coordinate) => {\n    for (let y = seamY; y < (h - 1); y += 1) {\n      const nextPixel = getPixel(img, { x: seamX, y: y + 1 });\n      setPixel(img, { x: seamX, y }, nextPixel);\n    }\n  });\n};\n\ntype ResizeAxisArgs = {\n  img: ImageData,\n  toSize: number,\n  size: ImageSize,\n  onIteration?: (args: OnIterationArgs) => Promise<void>,\n};\n\ntype ResizeImageArgs = {\n  img: ImageData,\n  toWidth: number,\n  toHeight: number,\n  onIteration?: (args: OnIterationArgs) => Promise<void>,\n};\n\nconst resizeImageWidth = async (args: ResizeAxisArgs): Promise<void> => {\n  const { img, toSize, onIteration, size } = args;\n\n  const pxToRemove = img.width - toSize;\n  if (pxToRemove < 0) {\n    throw new Error('Upsizing is not supported');\n  }\n\n  let energyMap: EnergyMap | null = null;\n  let seam: Seam | null = null;\n\n  for (let i = 0; i < pxToRemove; i += 1) {\n    energyMap = energyMap && seam\n      ? reCalculateEnergyMapH(img, size, energyMap, seam)\n      : calculateEnergyMapH(img, size);\n\n    seam = findLowEnergySeamH(energyMap, size);\n\n    deleteSeamH(img, seam, size);\n\n    if (onIteration) {\n      await onIteration({\n        energyMap,\n        seam,\n        img,\n        size,\n        step: i,\n        steps: pxToRemove,\n      });\n    }\n\n    size.w -= 1;\n\n    await wait(1);\n  }\n};\n\nconst resizeImageHeight = async (args: ResizeAxisArgs): Promise<void> => {\n  const { img, toSize, onIteration, size } = args;\n\n  const pxToRemove = img.height - toSize;\n  if (pxToRemove < 0) {\n    throw new Error('Upsizing is not supported');\n  }\n\n  let energyMap: EnergyMap | null = null;\n  let seam: Seam | null = null;\n\n  for (let i = 0; i < pxToRemove; i += 1) {\n    energyMap = energyMap && seam\n      ? reCalculateEnergyMapV(img, size, energyMap, seam)\n      : calculateEnergyMapV(img, size);\n\n    seam = findLowEnergySeamV(energyMap, size);\n\n    deleteSeamV(img, seam, size);\n\n    if (onIteration) {\n      await onIteration({\n        energyMap,\n        seam,\n        img,\n        size,\n        step: i,\n        steps: pxToRemove,\n      });\n    }\n\n    size.h -= 1;\n\n    await wait(1);\n  }\n};\n\nexport const resizeImage = async (args: ResizeImageArgs): Promise<void> => {\n  const {\n    img,\n    toWidth,\n    toHeight,\n    onIteration,\n  } = args;\n\n  const pxToRemoveH = img.width - toWidth;\n  const pxToRemoveV = img.height - toHeight;\n\n  const size: ImageSize = { w: img.width, h: img.height };\n\n  const globalSteps = pxToRemoveH + pxToRemoveV;\n  let globalStep = 0;\n\n  const onResizeIteration = async (onIterationArgs: OnIterationArgs): Promise<void> => {\n    const {\n      seam,\n      img: onIterationImg,\n      size: onIterationSize,\n      energyMap,\n    } = onIterationArgs;\n\n    globalStep += 1;\n\n    if (!onIteration) {\n      return;\n    }\n\n    await onIteration({\n      seam,\n      img: onIterationImg,\n      size: onIterationSize,\n      energyMap,\n      step: globalStep,\n      steps: globalSteps,\n    });\n  };\n\n  await resizeImageWidth({ img, toSize: toWidth, onIteration: onResizeIteration, size });\n  await resizeImageHeight({ img, toSize: toHeight, onIteration: onResizeIteration, size });\n};\n","import React, { useRef, useEffect } from 'react';\nimport { setPixel } from './imageUtils';\nimport { EnergyMap as EnergyMapType } from './contentAwareResizer';\n\ntype EnergyMapProps = {\n  energyMap: EnergyMapType | null,\n  width: number,\n  height: number,\n  className?: string,\n};\n\nconst normalizeEnergy = (\n  energy: number,\n  maxEnergy: number,\n  maxNormalizedEnergy: number,\n): number => {\n  return Math.floor((energy / maxEnergy) * maxNormalizedEnergy);\n};\n\nconst getMaxEnergy = (\n  energyMap: EnergyMapType,\n  width: number,\n  height: number,\n): number => {\n  let maxEnergy = 0;\n  for (let y = 0; y < height; y += 1) {\n    for (let x = 0; x < width; x += 1) {\n      maxEnergy = Math.max(maxEnergy, energyMap[y][x]);\n    }\n  }\n\n  return maxEnergy;\n};\n\nconst normalizeEnergyMap = (\n  energyMap: EnergyMapType,\n  width: number,\n  height: number,\n  maxNormalizedEnergy = 255,\n): number[][] => {\n  const maxEnergy = getMaxEnergy(energyMap, width, height);\n\n  const normalizedMap = new Array(height)\n    .fill(null)\n    .map(() => {\n      return new Array(width).fill(Infinity);\n    });\n\n  for (let y = 0; y < height; y += 1) {\n    for (let x = 0; x < width; x += 1) {\n      normalizedMap[y][x] = normalizeEnergy(energyMap[y][x], maxEnergy, maxNormalizedEnergy);\n    }\n  }\n\n  return normalizedMap;\n};\n\nconst EnergyMap = (props: EnergyMapProps): React.ReactElement => {\n  const {\n    energyMap,\n    className,\n    width,\n    height,\n  } = props;\n\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    if (!energyMap || !energyMap.length || !energyMap[0].length) {\n      return;\n    }\n    const energyCanvas: HTMLCanvasElement | null = canvasRef.current;\n    if (!energyCanvas) {\n      return;\n    }\n    const energyCtx: CanvasRenderingContext2D | null = energyCanvas.getContext('2d');\n    if (!energyCtx) {\n      return;\n    }\n\n    energyCanvas.width = width;\n    energyCanvas.height = height;\n\n    const imgData: ImageData = energyCtx.getImageData(0, 0, width, height);\n\n    const normalizedEnergyMap = normalizeEnergyMap(energyMap, width, height);\n\n    for (let y = 0; y < height; y += 1) {\n      for (let x = 0; x < width; x += 1) {\n        const norm = normalizedEnergyMap[y][x];\n        setPixel(imgData, { x, y }, [norm, norm, norm, 255]);\n      }\n    }\n\n    energyCtx.putImageData(imgData, 0, 0);\n  }, [energyMap, width, height]);\n\n  return (\n    <canvas ref={canvasRef} className={className} />\n  );\n};\n\nexport default EnergyMap;\n","import React, { useRef, useEffect } from 'react';\nimport { Seam } from './contentAwareResizer';\nimport { Coordinate } from './imageUtils';\n\ntype SeamProps = {\n  seams: Seam[],\n  width: number,\n  height: number,\n  className?: string,\n};\n\nconst Seams = (props: SeamProps): React.ReactElement => {\n  const {\n    seams,\n    width,\n    height,\n    className = '',\n  } = props;\n\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    if (!seams || !seams.length || !seams[0]) {\n      return;\n    }\n    const seamsCanvas: HTMLCanvasElement | null = canvasRef.current;\n    if (!seamsCanvas) {\n      return;\n    }\n    const seamsCtx: CanvasRenderingContext2D | null = seamsCanvas.getContext('2d');\n    if (!seamsCtx) {\n      return;\n    }\n\n    seamsCanvas.width = width;\n    seamsCanvas.height = height;\n\n    seamsCtx.fillStyle = 'rgba(255, 255, 255, 1)';\n    seams[0].forEach(({ x, y }: Coordinate) => {\n      seamsCtx.fillRect(x, y, 1, 1);\n    });\n  }, [seams, width, height]);\n\n  return (\n    <canvas ref={canvasRef} className={className} />\n  );\n};\n\nexport default Seams;\n","export default __webpack_public_path__ + \"static/02-044e70cf364e3bb36250efddd75e051e.jpg\";","import React, { CSSProperties } from 'react';\n\ntype ButtonKind = 'primary' | 'secondary';\n\nexport const BUTTON_KIND_PRIMARY: ButtonKind = 'primary';\nexport const BUTTON_KIND_SECONDARY: ButtonKind = 'secondary';\n\nexport type ButtonProps = {\n  children: React.ReactNode,\n  onClick?: () => void,\n  className?: string,\n  disabled?: boolean,\n  title?: string | undefined,\n  startEnhancer?: React.ReactNode,\n  style?: CSSProperties,\n  kind?: ButtonKind,\n};\n\nconst Button = (props: ButtonProps): React.ReactElement => {\n  const {\n    children,\n    className = '',\n    /* eslint-disable-next-line @typescript-eslint/no-empty-function */\n    onClick = (): void => {},\n    disabled = false,\n    title = undefined,\n    startEnhancer = null,\n    style = {},\n    kind = BUTTON_KIND_PRIMARY,\n  } = props;\n\n  const defaultClasses = ' transition duration-200 ease-in-out flex flex-row items-center uppercase font-medium text-xs tracking-wider';\n\n  const disabledClasses: Record<ButtonKind, string> = {\n    [BUTTON_KIND_PRIMARY]: 'cursor-not-allowed bg-white text-gray-500 hover:bg-white hover:text-gray-500 border-gray-300',\n    [BUTTON_KIND_SECONDARY]: 'cursor-not-allowed bg-white text-gray-500 hover:bg-white hover:text-gray-500 border-gray-300',\n  };\n\n  const kindClasses: Record<ButtonKind, string> = {\n    [BUTTON_KIND_PRIMARY]: 'hover:bg-white hover:text-black py-2 px-3 rounded shadow-sm border border-solid border-white hover:border-gray-400 bg-black text-white',\n    [BUTTON_KIND_SECONDARY]: 'bg-white text-black py-2 px-3 rounded shadow-sm border border-solid hover:border-white border-gray-400 hover:bg-black hover:text-white',\n  };\n\n  const classes = `${defaultClasses} ${kindClasses[kind]} ${disabled ? disabledClasses[kind] : ''} ${className}`;\n\n  const separator = startEnhancer ? (\n    <span className=\"w-2\" />\n  ) : null;\n\n  return (\n    <button\n      className={classes}\n      onClick={onClick}\n      type=\"button\"\n      disabled={disabled}\n      title={title}\n      style={style}\n    >\n      {startEnhancer}\n      {separator}\n      {children}\n    </button>\n  );\n};\n\nexport default Button;\n","import React, { ChangeEvent } from 'react';\nimport { FaFileImage } from '@react-icons/all-files/fa/FaFileImage';\nimport Button from '../../../../components/shared/Button';\n\ntype FileSelectorProps = {\n  onSelect: (files: FileList | null) => void;\n  accept?: string, // i.e. 'image/png,image/jpeg'\n  capture?: 'user' | 'environment',\n  multiple?: boolean,\n  children: React.ReactNode,\n  disabled?: boolean,\n};\n\nconst FileSelector = (props: FileSelectorProps): React.ReactElement => {\n  const {\n    onSelect,\n    accept,\n    capture,\n    multiple = false,\n    disabled = false,\n    children,\n  } = props;\n\n  const onChange = (event: ChangeEvent): void => {\n    const { files } = (event.target as HTMLInputElement);\n    onSelect(files);\n  };\n\n  const icon = (\n    <div className=\"mr-2\">\n      <FaFileImage size={14} />\n    </div>\n  );\n\n  const disabledClasses = disabled ? 'cursor-not-allowed' : '';\n\n  /* eslint-disable jsx-a11y/label-has-associated-control */\n  return (\n    <Button style={{ padding: 0 }} disabled={disabled}>\n      <label className={`cursor-pointer py-2 px-3 flex uppercase font-medium text-xs tracking-wider ${disabledClasses}`}>\n        <input\n          type=\"file\"\n          accept={accept}\n          capture={capture}\n          onChange={onChange}\n          multiple={multiple}\n          className=\"hidden\"\n          disabled={disabled}\n        />\n        {icon}\n        {children}\n      </label>\n    </Button>\n  );\n};\n\nexport default FileSelector;\n","import React, { useRef } from 'react';\n\nexport type CheckboxProps = {\n  children: React.ReactNode,\n  onChange?: (state: boolean) => void,\n  className?: string,\n  disabled?: boolean,\n};\n\nconst Checkbox = (props: CheckboxProps): React.ReactElement => {\n  const {\n    children,\n    className = '',\n    /* eslint-disable-next-line @typescript-eslint/no-empty-function */\n    onChange = (): void => {},\n    disabled = false,\n  } = props;\n\n  const checkboxRef = useRef<HTMLInputElement>(null);\n\n  const disabledClasses = disabled ? 'cursor-not-allowed text-gray-500' : '';\n  const defaultClasses = 'flex items-center cursor-pointer';\n  const classes = `${defaultClasses} ${disabledClasses} ${className}`;\n\n  const onCheckboxChange = (): void => {\n    if (!checkboxRef.current) {\n      return;\n    }\n    onChange(checkboxRef.current.checked);\n  };\n\n  /* eslint-disable jsx-a11y/label-has-associated-control */\n  return (\n    <label className={classes}>\n      <input\n        type=\"checkbox\"\n        disabled={disabled}\n        onChange={onCheckboxChange}\n        ref={checkboxRef}\n      />\n      <div className=\"ml-2\">{children}</div>\n    </label>\n  );\n};\n\nexport default Checkbox;\n","import React, { CSSProperties } from 'react';\n\ntype ZeroToOne = number;\n\nexport type CheckboxProps = {\n  progress: ZeroToOne,\n};\n\nconst Progress = (props: CheckboxProps): React.ReactElement => {\n  const { progress } = props;\n\n  const progressPercentage = Math.min(Math.ceil(100 * progress), 100);\n  const barStyle: CSSProperties = {\n    width: `${progressPercentage}%`,\n    transition: 'width 0.5s',\n  };\n\n  return (\n    <div className=\"bg-gray-100 h-0.5 overflow-hidden flex flex-row justify-start items-center rounded\">\n      <div className=\"bg-black w-36 h-full transition duration-500 ease-in-out rounded transition\" style={barStyle} />\n    </div>\n  );\n};\n\nexport default Progress;\n","import React, { ChangeEvent } from 'react';\n\nexport type InputProps = {\n  onChange?: (value: string) => void,\n  className?: string,\n  disabled?: boolean,\n  value?: string | ReadonlyArray<string> | number,\n};\n\nconst Input = (props: InputProps): React.ReactElement => {\n  const {\n    disabled = false,\n    className = '',\n    /* eslint-disable-next-line @typescript-eslint/no-empty-function */\n    onChange = (): void => {},\n    value,\n    ...rest\n  } = props;\n\n  const disabledClasses = disabled ? 'border-gray-300 text-gray-500 cursor-not-allowed' : '';\n  const defaultClasses = 'border border-solid border-black rounded px-2 py-1 text-sm';\n  const classes = `${defaultClasses} ${disabledClasses} ${className}`;\n\n  const onInputChange = (event: ChangeEvent<HTMLInputElement>): void => {\n    onChange(event.target.value);\n  };\n\n  return (\n    <div className=\"flex flex-row justify-center items-center\">\n      <input\n        disabled={disabled}\n        onChange={onInputChange}\n        className={classes}\n        value={value}\n        {...rest}\n      />\n    </div>\n  );\n};\n\nexport default Input;\n","import React from 'react';\n\nimport './FadeIn.css';\n\ntype FadeInProps = {\n  children: React.ReactNode,\n  className?: string,\n};\n\nconst FadeIn = (props: FadeInProps): React.ReactElement => {\n  const { children, className = '' } = props;\n\n  return (\n    <div className={`custom-fade-in-opacity ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nexport default FadeIn;\n","/* eslint-disable @typescript-eslint/no-empty-function */\nimport React, {\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\n\nconst defaultBackgroundColor = 'rgba(0, 0, 0, 0)';\n\ntype MouseCoordinate = {\n  x: number,\n  y: number,\n};\n\ntype MaskProps = {\n  disabled?: boolean,\n  width?: number,\n  height?: number,\n  lineWidth?: number,\n  lineJoin?: CanvasLineJoin,\n  lineColor?: string,\n  backgroundColor?: string,\n  revision?: number,\n  onDrawEnd?: (imageData: ImageData) => void,\n};\n\nconst Mask = (props: MaskProps): React.ReactElement => {\n  const {\n    disabled = false,\n    width = 200,\n    height = 200,\n    lineColor = 'rgba(255, 0, 0, 1)',\n    lineWidth = 16,\n    lineJoin = 'round',\n    backgroundColor = defaultBackgroundColor,\n    revision = 0,\n    onDrawEnd: onDrawEndCallback,\n  } = props;\n\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [isPainting, setIsPainting] = useState<boolean>(false);\n  const [mousePosition, setMousePosition] = useState<MouseCoordinate | null>(null);\n\n  const getCoordinates = (event: MouseEvent): MouseCoordinate | null => {\n    if (!canvasRef.current) {\n      return null;\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    return {\n      x: event.pageX - canvas.offsetLeft,\n      y: event.pageY - canvas.offsetTop,\n    };\n  };\n\n  const startPaint = useCallback((event: MouseEvent) => {\n    if (disabled) {\n      return;\n    }\n    const coordinates = getCoordinates(event);\n    if (coordinates) {\n      setMousePosition(coordinates);\n      setIsPainting(true);\n    }\n  }, [disabled]);\n\n  const paint = useCallback(\n    (event: MouseEvent) => {\n      const drawLine = (\n        originalMousePosition: MouseCoordinate,\n        newMousePosition: MouseCoordinate,\n      ): void => {\n        if (!canvasRef.current || disabled) {\n          return;\n        }\n        const canvas: HTMLCanvasElement = canvasRef.current;\n        const context = canvas.getContext('2d');\n        if (context) {\n          context.strokeStyle = lineColor;\n          context.lineJoin = lineJoin;\n          context.lineWidth = lineWidth;\n          context.beginPath();\n          context.moveTo(originalMousePosition.x, originalMousePosition.y);\n          context.lineTo(newMousePosition.x, newMousePosition.y);\n          context.closePath();\n          context.stroke();\n        }\n      };\n\n      if (isPainting) {\n        const newMousePosition = getCoordinates(event);\n        if (mousePosition && newMousePosition) {\n          drawLine(mousePosition, newMousePosition);\n          setMousePosition(newMousePosition);\n        }\n      }\n    },\n    [isPainting, mousePosition, lineColor, lineJoin, lineWidth, disabled],\n  );\n\n  const exitPaint = useCallback(() => {\n    const onDrawEnd = (): void => {\n      if (!canvasRef.current || disabled) {\n        return;\n      }\n\n      const canvas: HTMLCanvasElement = canvasRef.current;\n      const context = canvas.getContext('2d');\n\n      // Call a callback.\n      if (onDrawEndCallback && context) {\n        onDrawEndCallback(\n          context.getImageData(0, 0, canvas.width, canvas.height),\n        );\n      }\n    };\n\n    onDrawEnd();\n    setIsPainting(false);\n    setMousePosition(null);\n  }, [onDrawEndCallback, disabled]);\n\n  // Effect for MouseDown.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return (): void => {};\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    canvas.addEventListener('mousedown', startPaint);\n    // @ts-ignore\n    canvas.addEventListener('touchstart', startPaint);\n\n    return (): void => {\n      canvas.removeEventListener('mousedown', startPaint);\n      // @ts-ignore\n      canvas.removeEventListener('touchstart', startPaint);\n    };\n  }, [startPaint]);\n\n  // Effect for MouseMove.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return (): void => {};\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    canvas.addEventListener('mousemove', paint);\n    // @ts-ignore\n    canvas.addEventListener('touchmove', paint);\n\n    return (): void => {\n      canvas.removeEventListener('mousemove', paint);\n      // @ts-ignore\n      canvas.removeEventListener('touchmove', paint);\n    };\n  }, [paint]);\n\n  // Effect for MouseUp and MouseLeave.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return (): void => {};\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    canvas.addEventListener('mouseup', exitPaint);\n    canvas.addEventListener('mouseleave', exitPaint);\n    canvas.addEventListener('touchend', exitPaint);\n    canvas.addEventListener('touchcancel', exitPaint);\n\n    return (): void => {\n      canvas.removeEventListener('mouseup', exitPaint);\n      canvas.removeEventListener('mouseleave', exitPaint);\n      canvas.removeEventListener('touchend', exitPaint);\n      canvas.removeEventListener('touchcancel', exitPaint);\n    };\n  }, [exitPaint]);\n\n  // Effect for filling a canvases with color.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return;\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    const context = canvas.getContext('2d');\n    if (context) {\n      context.fillStyle = backgroundColor;\n      context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n  }, [backgroundColor]);\n\n  // Effect to cleanup the canvas.\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return;\n    }\n    const canvas: HTMLCanvasElement = canvasRef.current;\n    const context = canvas.getContext('2d');\n    if (context) {\n      context.fillStyle = backgroundColor;\n      context.clearRect(0, 0, canvas.width, canvas.height);\n      context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n  }, [revision, backgroundColor]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={width}\n      height={height}\n      style={{ touchAction: 'none' }}\n    />\n  );\n};\n\nexport default Mask;\n","import React, { useEffect, useRef, useState } from 'react';\nimport { ImShrink2 } from '@react-icons/all-files/im/ImShrink2';\nimport { FaRegHandPointer } from '@react-icons/all-files/fa/FaRegHandPointer';\nimport { MdLayersClear } from '@react-icons/all-files/md/MdLayersClear';\n\nimport {\n  EnergyMap as EnergyMapType,\n  Seam,\n  OnIterationArgs,\n  ImageSize,\n  resizeImage,\n  ALPHA_DELETE_THRESHOLD,\n  MAX_WIDTH_LIMIT,\n  MAX_HEIGHT_LIMIT,\n} from './contentAwareResizer';\nimport EnergyMap from './EnergyMap';\nimport Seams from './Seams';\nimport defaultImgSrc from '../assets/02.jpg';\nimport Button, { BUTTON_KIND_SECONDARY } from '../../../../components/shared/Button';\nimport FileSelector from './FileSelector';\nimport Checkbox from '../../../../components/shared/Checkbox';\nimport Progress from '../../../../components/shared/Progress';\nimport Input from '../../../../components/shared/Input';\nimport FadeIn from '../../../../components/shared/FadeIn';\nimport Mask from './Mask';\nimport { Coordinate, getPixel, setPixel } from './imageUtils';\n\nconst defaultWidthScale = 50;\nconst defaultHeightScale = 70;\nconst minScale = 1;\nconst maxScale = 100;\nconst maxWidthLimit = MAX_WIDTH_LIMIT;\nconst maxHeightLimit = MAX_HEIGHT_LIMIT;\n\ntype ImageResizerProps = {\n  withSeam?: boolean,\n  withEnergyMap?: boolean,\n  withCredentials?: boolean,\n};\n\nconst ImageResizer = (props: ImageResizerProps): React.ReactElement => {\n  const {\n    withSeam = false,\n    withEnergyMap = false,\n    withCredentials = false,\n  } = props;\n\n  const [imgAuthor, setImgAuthor] = useState<string | null>('Ian Dooley');\n  const [imgAuthorURL, setImgAuthorURL] = useState<string | null>(\n    'https://unsplash.com/@sadswim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText',\n  );\n\n  const [useNaturalSize, setUseNaturalSize] = useState<boolean>(false);\n  const [imageSrc, setImageSrc] = useState<string>(defaultImgSrc);\n  const [resizedImgSrc, setResizedImgSrc] = useState<string | null>(null);\n  const [energyMap, setEnergyMap] = useState<EnergyMapType | null>(null);\n  const [originalImgSize, setOriginalImgSize] = useState<ImageSize | null>(null);\n  const [originalImgViewSize, setOriginalImgViewSize] = useState<ImageSize | null>(null);\n  const [workingImgSize, setWorkingImgSize] = useState<ImageSize | null>(null);\n  const [seams, setSeams] = useState<Seam[] | null>(null);\n  const [isResizing, setIsResizing] = useState<boolean>(false);\n  const [progress, setProgress] = useState<number>(0);\n  const [maskImgData, setMaskImgData] = useState<ImageData | null>(null);\n  const [maskRevision, setMaskRevision] = useState<number>(0);\n  const [toWidthScale, setToWidthScale] = useState<number>(defaultWidthScale);\n  const [toWidthScaleString, setToWidthScaleString] = useState<string | undefined>(`${defaultWidthScale}`);\n  const [toHeightScale, setToHeightScale] = useState<number>(defaultHeightScale);\n  const [toHeightScaleString, setToHeightScaleString] = useState<string | undefined>(`${defaultHeightScale}`);\n\n  const imgRef = useRef<HTMLImageElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const onUseOriginalSizeChange = (state: boolean): void => {\n    setUseNaturalSize(state);\n  };\n\n  const onReset = (): void => {\n    setResizedImgSrc(null);\n    setSeams(null);\n    setWorkingImgSize(null);\n    setEnergyMap(null);\n    setProgress(0);\n    setOriginalImgViewSize(null);\n  };\n\n  const onFileSelect = (files: FileList | null): void => {\n    if (!files || !files.length) {\n      return;\n    }\n    setImgAuthor(null);\n    setImgAuthorURL(null);\n    onReset();\n    const imageURL = URL.createObjectURL(files[0]);\n    setImageSrc(imageURL);\n  };\n\n  const onWidthSizeChange = (size: string | undefined): void => {\n    const radix = 10;\n    const scale = Math.max(Math.min(parseInt(size || '0', radix), maxScale), minScale);\n    if (size) {\n      setToWidthScaleString(`${scale}`);\n    } else {\n      setToWidthScaleString(size);\n    }\n    setToWidthScale(scale);\n  };\n\n  const onHeightSizeChange = (size: string | undefined): void => {\n    const radix = 10;\n    const scale = Math.max(Math.min(parseInt(size || '0', radix), maxScale), minScale);\n    if (size) {\n      setToHeightScaleString(`${scale}`);\n    } else {\n      setToHeightScaleString(size);\n    }\n    setToHeightScale(scale);\n  };\n\n  const onFinish = (): void => {\n    if (!canvasRef.current) {\n      return;\n    }\n    const imageType = 'image/png';\n    canvasRef.current.toBlob((blob: Blob | null): void => {\n      if (!blob) {\n        return;\n      }\n      const imgUrl = URL.createObjectURL(blob);\n      setResizedImgSrc(imgUrl);\n      setIsResizing(false);\n    }, imageType);\n  };\n\n  const onClearMask = (): void => {\n    setMaskRevision(maskRevision + 1);\n  };\n\n  const onMaskDrawEnd = (imgData: ImageData): void => {\n    setMaskImgData(imgData);\n  };\n\n  const applyMask = (img: ImageData): void => {\n    if (!maskImgData) {\n      return;\n    }\n\n    const wRatio = maskImgData.width / img.width;\n    const hRatio = maskImgData.height / img.height;\n\n    const imgXYtoMaskXY = ({ x: imgX, y: imgY }: Coordinate): Coordinate => {\n      return {\n        x: Math.floor(imgX * wRatio),\n        y: Math.floor(imgY * hRatio),\n      };\n    };\n\n    for (let y = 0; y < img.height; y += 1) {\n      for (let x = 0; x < img.width; x += 1) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const [mR, mG, mB, mA] = getPixel(\n          maskImgData,\n          imgXYtoMaskXY({ x, y }),\n        );\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const [iR, iG, iB, iA] = getPixel(img, { x, y });\n        if (mA) {\n          setPixel(img, { x, y }, [iR, iG, iB, ALPHA_DELETE_THRESHOLD]);\n        }\n      }\n    }\n  };\n\n  const onIteration = async (args: OnIterationArgs): Promise<void> => {\n    const {\n      seam,\n      img,\n      energyMap: nrgMap,\n      size: { w, h },\n      step,\n      steps,\n    } = args;\n\n    const canvas: HTMLCanvasElement | null = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n\n    canvas.width = w;\n    canvas.height = h;\n\n    const ctx: CanvasRenderingContext2D | null = canvas.getContext('2d');\n    if (!ctx) {\n      return;\n    }\n\n    ctx.putImageData(img, 0, 0, 0, 0, w, h);\n\n    setEnergyMap(nrgMap);\n    setSeams([seam]);\n    setWorkingImgSize({ w, h });\n    setProgress(step / steps);\n  };\n\n  const onResize = (): void => {\n    const srcImg: HTMLImageElement | null = imgRef.current;\n    if (!srcImg) {\n      return;\n    }\n    const canvas: HTMLCanvasElement | null = canvasRef.current;\n    if (!canvas) {\n      return;\n    }\n\n    onReset();\n    setIsResizing(true);\n\n    let w = useNaturalSize ? srcImg.naturalWidth : srcImg.width;\n    let h = useNaturalSize ? srcImg.naturalHeight : srcImg.height;\n    const ratio = w / h;\n\n    setOriginalImgViewSize({\n      w: srcImg.width,\n      h: srcImg.height,\n    });\n\n    if (w > maxWidthLimit) {\n      w = maxWidthLimit;\n      h = Math.floor(w / ratio);\n    }\n\n    if (h > maxHeightLimit) {\n      h = maxHeightLimit;\n      w = Math.floor(h * ratio);\n    }\n\n    canvas.width = w;\n    canvas.height = h;\n\n    const ctx: CanvasRenderingContext2D | null = canvas.getContext('2d');\n    if (!ctx) {\n      return;\n    }\n\n    ctx.drawImage(srcImg, 0, 0, w, h);\n\n    const img: ImageData = ctx.getImageData(0, 0, w, h);\n\n    applyMask(img);\n\n    const toWidth = Math.floor((toWidthScale * w) / 100);\n    const toHeight = Math.floor((toHeightScale * h) / 100);\n\n    resizeImage({\n      img,\n      toWidth,\n      toHeight,\n      onIteration,\n    }).then(() => {\n      onFinish();\n    });\n  };\n\n  useEffect(() => {\n    const srcImg: HTMLImageElement | null = imgRef.current;\n    if (!srcImg) {\n      return;\n    }\n    srcImg.addEventListener('load', () => {\n      if (!imgRef.current) {\n        return;\n      }\n      setOriginalImgSize({\n        w: imgRef.current.naturalWidth,\n        h: imgRef.current.naturalHeight,\n      });\n      setOriginalImgViewSize({\n        w: imgRef.current.width,\n        h: imgRef.current.height,\n      });\n    });\n  }, []);\n\n  useEffect(() => {\n    function updateSize(): void {\n      if (!imgRef.current) {\n        return;\n      }\n      setOriginalImgViewSize({\n        w: imgRef.current.width,\n        h: imgRef.current.height,\n      });\n    }\n    window.addEventListener('resize', updateSize);\n    return (): void => {\n      window.removeEventListener('resize', updateSize);\n    };\n  }, []);\n\n  const imgAuthorLink = withCredentials && imgAuthor && imgAuthorURL ? (\n    <div className=\"text-xs text-gray-400 mt-2 flex justify-center items-center font-light\">\n      <div className=\"mr-1\">\n        Photo by\n      </div>\n      <a\n        href={imgAuthorURL}\n        style={{ color: '#aaa', fontWeight: 300 }}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        {imgAuthor}\n      </a>\n    </div>\n  ) : null;\n\n  const seamsCanvas = withSeam && workingImgSize && seams ? (\n    <div style={{ marginTop: `-${workingImgSize.h}px` }}>\n      <Seams seams={seams} width={workingImgSize.w} height={workingImgSize.h} />\n    </div>\n  ) : null;\n\n  const originalImageSizeText = originalImgSize ? (\n    <sup className=\"text-xs text-gray-400 whitespace-nowrap\">\n      {`${originalImgSize.w} x ${originalImgSize.h} px`}\n    </sup>\n  ) : null;\n\n  const maskControls = (\n    <div>\n      <Button\n        onClick={onClearMask}\n        disabled={isResizing || !maskImgData}\n        kind={BUTTON_KIND_SECONDARY}\n        title=\"Clear mask\"\n        className=\"rounded-full\"\n        style={{ padding: '8px 8px', border: 0, outline: 'none' }}\n      >\n        <MdLayersClear size={16} />\n      </Button>\n    </div>\n  );\n\n  const mask = originalImgViewSize ? (\n    <div className=\"flex flex-col\" style={{ marginTop: `-${originalImgViewSize.h}px` }}>\n      <Mask\n        width={originalImgViewSize.w}\n        height={originalImgViewSize.h}\n        disabled={isResizing}\n        onDrawEnd={onMaskDrawEnd}\n        revision={maskRevision}\n      />\n      <div className=\"flex flex-row justify-end\" style={{ marginTop: '-36px', zIndex: 100 }}>\n        <div className=\"mr-1\">\n          {maskControls}\n        </div>\n      </div>\n    </div>\n  ) : null;\n\n  const originalImage = (\n    <FadeIn>\n      <div className=\"flex flex-row justify-center items-center mb-1 sm:mb-0\">\n        <div className=\"flex-1 sm:flex sm:flex-row sm:items-center\">\n          <div className=\"sm:flex-1\">\n            <b>Original image</b> {originalImageSizeText}\n          </div>\n          <div className=\"text-xs text-gray-400 flex flex-row items-center justify-self-end\">\n            <div className=\"mr-1\">\n              <FaRegHandPointer size={12} />\n            </div>\n            <div>\n              Mask to remove\n            </div>\n          </div>\n        </div>\n      </div>\n      <img src={imageSrc} alt=\"Original\" ref={imgRef} style={{ margin: 0 }} />\n      {mask}\n      {imgAuthorLink}\n    </FadeIn>\n  );\n\n  const workingImageScrollableText = (\n    workingImgSize?.w && originalImgViewSize?.w && workingImgSize.w > originalImgViewSize.w\n  ) ? <span className=\"text-xs text-gray-400 ml-4\"> scrollable</span> : null;\n\n  const workingImageSizeText = workingImgSize ? (\n    <sup className=\"text-xs text-gray-400 whitespace-nowrap\">\n      {`${workingImgSize.w} x ${workingImgSize.h} px`}\n    </sup>\n  ) : null;\n\n  const workingImage = (\n    <FadeIn className={`mb-6 ${resizedImgSrc || !energyMap ? 'hidden' : ''}`}>\n      <div><b>Resized image</b> {workingImageSizeText} {workingImageScrollableText}</div>\n      <div className=\"overflow-scroll\">\n        <canvas ref={canvasRef} />\n        {seamsCanvas}\n      </div>\n    </FadeIn>\n  );\n\n  const resultImageSizeText = workingImgSize ? (\n    <sup className=\"text-xs text-gray-400 whitespace-nowrap\">\n      {`${workingImgSize.w} x ${workingImgSize.h} px`}\n    </sup>\n  ) : null;\n\n  const resultImage = workingImgSize && resizedImgSrc ? (\n    <FadeIn className=\"mb-6\">\n      <div><b>Resized image</b> {resultImageSizeText}</div>\n      <img src={resizedImgSrc} width={workingImgSize.w} height={workingImgSize.h} alt=\"Resized\" style={{ margin: 0 }} />\n    </FadeIn>\n  ) : null;\n\n  const debugEnergyMap = withEnergyMap && workingImgSize ? (\n    <FadeIn className=\"mb-6\">\n      <div><b>Energy map</b></div>\n      <EnergyMap energyMap={energyMap} width={workingImgSize.w} height={workingImgSize.h} />\n      {seamsCanvas}\n    </FadeIn>\n  ) : null;\n\n  const resizerControls = (\n    <div className=\"flex flex-col justify-start items-start mb-1\">\n\n      <div className=\"mb-3 flex flex-row\">\n        <div className=\"mr-2\">\n          <FileSelector\n            onSelect={onFileSelect}\n            disabled={isResizing}\n            accept=\"image/png,image/jpeg\"\n          >\n            Choose image\n          </FileSelector>\n        </div>\n\n        <div>\n          <Button\n            onClick={onResize}\n            disabled={isResizing || !toWidthScaleString}\n            startEnhancer={<ImShrink2 size={14} />}\n          >\n            Resize\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row\">\n        <div className=\"mb-2 mr-6 flex flex-row items-center\">\n          <div className=\"text-xs mr-1\">Width</div>\n          <Input\n            onChange={onWidthSizeChange}\n            disabled={isResizing}\n            // @ts-ignore\n            type=\"number\"\n            min={minScale}\n            max={maxScale}\n            className=\"w-14 text-center\"\n            value={toWidthScaleString}\n          />\n          <div className=\"text-xs ml-1 mr-4\">%</div>\n\n          <div className=\"text-xs mr-1\">Height</div>\n          <Input\n            onChange={onHeightSizeChange}\n            disabled={isResizing}\n            // @ts-ignore\n            type=\"number\"\n            min={minScale}\n            max={maxScale}\n            className=\"w-14 text-center\"\n            value={toHeightScaleString}\n          />\n          <div className=\"text-xs ml-1\">%</div>\n        </div>\n\n        <div className=\"mb-2\">\n          <Checkbox disabled={isResizing} onChange={onUseOriginalSizeChange}>\n            <span className=\"text-xs\">\n              Higher quality <span className=\"text-gray-400\">(takes longer)</span>\n            </span>\n          </Checkbox>\n        </div>\n      </div>\n\n    </div>\n  );\n\n  const progressBar = (\n    <div className=\"mb-6\">\n      <Progress progress={progress} />\n    </div>\n  );\n\n  return (\n    <>\n      {resizerControls}\n      {progressBar}\n      {workingImage}\n      {resultImage}\n      {debugEnergyMap}\n      {originalImage}\n    </>\n  );\n};\n\nexport default ImageResizer;\n","/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nimport ImageResizer from './components/ImageResizer';\nimport InteractivePostArea from '../../../components/shared/InteractivePostArea';\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    span: \"span\",\n    p: \"p\",\n    h2: \"h2\",\n    a: \"a\",\n    em: \"em\",\n    ol: \"ol\",\n    li: \"li\",\n    strong: \"strong\",\n    h3: \"h3\",\n    img: \"img\",\n    ul: \"ul\",\n    blockquote: \"blockquote\",\n    h4: \"h4\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 47.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACdklEQVR42i3J30sTAQDA8SN6qqAekqAiepAogiAQQnqRfmgRFWRJP9B+SCUhPmQRlRmZiaFiNisnTlPTnM5tbrfpbrvbbbvbvNttbm6zMv1bvlH0+vkIwtgC25wS1WqW45Mu6m19CCNuKsUYFX6VXd/8nEtk2Tolsr1niANTImekFILDy84JPzvtTsqc0n/zIOyYDVPeO8Rpd5hLQZnqD/3s9ahcVdNsmRSpTea50jnMwTc2jj14yNnZRcpFDWFS5OI3J49ft7N7TqJGSSNM+BEOu2UqPjo4Px+i2Syx9XuYRm2Fo4EEhzwyz4sb1Ld2c+RZD/u9Co1xiz0ulbYZO9cH3rFveomjHpkbMYuyWQmhyhPhvp6jXc9Sp5jU9dp5GjV4OeqmaszLhZDOE2OV6iWdE54Iz5bzNKgW1S6RU3MiJ8U4lZ4ILfoKp8UYQkNI44tV5Nb4PHecQe4NjvNWz2Ab+srt735qAnFaglEcyxaPYhaXfQrtqRwd1ho3QzrXAjGuLybotkrUBuMITaLKZ3OV58k8w/YJ+gaHsOkGrYpOk5ykOZyiPSDxQZIZK2zwKKTR5Jb4FEowsvqLRjHKgFXkfTLLXVFBeCUqDGppXGsbdCyp9MYNPD826dcsur0h3kU0uuImc8Xf/65TSdETTTGfW6NXs+j7e2ubdPmCtC0sIXyKaiysFLAHJIZjKRLrm7iMLGOayaScwBHVcBsZooUSM2EJh5bGmc6xkDB5MerElysxk87TE1SwKTpCv28aeSWDbXwKo1AiWSgS1JKE4hphK0t42SBipMmt/0YxLRb1ZSQzg57J45Zk0j/XmVMSeNU4vpTJHxrPBN7vTRlaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Content-aware image resizing in JavaScript\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/2cd9684505d17ed7b88260b95bd5b0eb/00d43/01-cover-02.png\\\"\\n        srcset=\\\"/static/2cd9684505d17ed7b88260b95bd5b0eb/63868/01-cover-02.png 250w,\\n/static/2cd9684505d17ed7b88260b95bd5b0eb/0b533/01-cover-02.png 500w,\\n/static/2cd9684505d17ed7b88260b95bd5b0eb/00d43/01-cover-02.png 1000w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(\"div\", {\n    className: \"text-xs text-gray-400 mt-2 flex justify-center items-center font-light\"\n  }, React.createElement(\"div\", {\n    className: \"mr-1\"\n  }, React.createElement(_components.p, null, \"Background image by\")), React.createElement(\"a\", {\n    href: \"https://unsplash.com/@sadswim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\",\n    style: {\n      color: '#aaa',\n      fontWeight: 300\n    },\n    target: \"_blank\",\n    rel: \"noreferrer\"\n  }, React.createElement(_components.p, null, \"Ian Dooley\"))), \"\\n\", React.createElement(_components.h2, {\n    id: \"tldr\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"TL;DR\", React.createElement(_components.a, {\n    href: \"#tldr\",\n    \"aria-label\": \"tldr permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"There are many great articles written about the \", React.createElement(_components.em, null, \"Seam Carving algorithm\"), \" already, but I couldn't resist the temptation to explore this elegant, powerful, and \", React.createElement(_components.em, null, \"yet simple\"), \" algorithm on my own, and to write about my personal experience with it. Another point that drew my attention (as a creator of \", React.createElement(_components.a, {\n    href: \"https://github.com/trekhleb/javascript-algorithms\"\n  }, \"javascript-algorithms\"), \" repo) was the fact that \", React.createElement(_components.em, null, \"Dynamic Programming (DP)\"), \" approach might be smoothly applied to solve it. And, if you're like me and still on your \\\"learning algorithms\\\" journey, this algorithmic solution may enrich your personal DP arsenal.\"), \"\\n\", React.createElement(_components.p, null, \"So, with this article I want to do three things:\"), \"\\n\", React.createElement(_components.ol, null, \"\\n\", React.createElement(_components.li, null, \"Provide you with an interactive \", React.createElement(_components.strong, null, \"content-aware resizer\"), \" so that you could play around with resizing your own images\"), \"\\n\", React.createElement(_components.li, null, \"Explain the idea behind the \", React.createElement(_components.strong, null, \"Seam Carving algorithm\")), \"\\n\", React.createElement(_components.li, null, \"Explain the \", React.createElement(_components.strong, null, \"dynamic programming approach\"), \" to implement the algorithm (we'll be using TypeScript for it)\"), \"\\n\"), \"\\n\", React.createElement(_components.h3, {\n    id: \"content-aware-image-resizing\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Content-aware image resizing\", React.createElement(_components.a, {\n    href: \"#content-aware-image-resizing\",\n    \"aria-label\": \"content aware image resizing permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.em, null, \"Content-aware image resizing\"), \" might be applied when it comes to changing the image proportions (i.e. reducing the width while keeping the height) and when losing some parts of the image is not desirable. Doing the straightforward image scaling in this case would distort the objects in it. To preserve the proportions of the objects while changing the image proportions we may use the \", React.createElement(_components.a, {\n    href: \"https://perso.crans.org/frenoy/matlab2012/seamcarving.pdf\"\n  }, \"Seam Carving algorithm\"), \" that was introduced by \", React.createElement(_components.em, null, \"Shai Avidan\"), \" and \", React.createElement(_components.em, null, \"Ariel Shamir\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"The example below shows how the original image width was reduced by 50% using \", React.createElement(_components.em, null, \"content-aware resizing\"), \" (left image) and \", React.createElement(_components.em, null, \"straightforward scaling\"), \" (right image). In this particular case, the left image looks more natural since the proportions of the balloons were preserved.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 25.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYUlEQVR42l2OPS8DAQCGbzJYMBgYJH4AsQkJi823wcJgIfELhIHBQGohkYjPShu0p0Ob3vXqtEf1SH1cq+I7PiJtIiirCO4ecYnFm7zL++RJXqF4UaRyeZWCKRelk/OUzLjx3WX5zadp8m1Zdk3gy7L4Mk2buW6z5M15KHQHyJ9eoWjOQ5k3jFC9vE7tapC68QUaltzUzzvxZ55safjolEZ5i1YlTkcgQnNIY9C4sJl0l6Hc5afKq1AxK1Kz4qPWv4nQ55UZmHbSH1Dp3tBpD+uIRpr3txwju0manOu0iTItPoUGr8TAboqP3Ati+oyeNYl+T5AuVacztEOvto8wIUdwhDUc6jYOZYshKUryIWO/SFzfsJE6IXZ2Sez8Csk44fD23mbJzCOjIY2xiM54VGdUjTOxnUCYVWSUxBHaoYEU03GpGtncqy1ZlsX//G33z094YnGiyTTR1DHBvX3kA4MfiGs6b4LBw/8AAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Content-aware image resizing\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/e699bb9028be167a7a2ec54c8dd4268e/00d43/01-resizing-options.png\\\"\\n        srcset=\\\"/static/e699bb9028be167a7a2ec54c8dd4268e/63868/01-resizing-options.png 250w,\\n/static/e699bb9028be167a7a2ec54c8dd4268e/0b533/01-resizing-options.png 500w,\\n/static/e699bb9028be167a7a2ec54c8dd4268e/00d43/01-resizing-options.png 1000w,\\n/static/e699bb9028be167a7a2ec54c8dd4268e/f53a0/01-resizing-options.png 1062w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"The Seam Carving algorithm's idea is to find the \", React.createElement(_components.em, null, \"seam\"), \" (continuous sequence of pixels) with the lowest contribution to the image content and then \", React.createElement(_components.em, null, \"carve\"), \" (remove) it. This process repeats over and over again until we get the required image width or height. In the example below you may see that the hot air balloon pixels contribute more to the content of the image than the sky pixels. Thus, the sky pixels are being removed first.\"), \"\\n\", React.createElement(_components.img, {\n    src: \"/posts-assets/be0bb730305f59e7c213aaab90f8aff5/10-demo-01.gif\",\n    alt: \"JS IMAGE CARVER DEMO\"\n  }), \"\\n\", React.createElement(_components.p, null, \"Finding the seam with the lowest energy is a computationally expensive task (especially for large images). To make the seam search faster the \", React.createElement(_components.em, null, \"dynamic programming\"), \" approach might be applied (we will go through the implementation details below).\"), \"\\n\", React.createElement(_components.h3, {\n    id: \"objects-removal\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Objects removal\", React.createElement(_components.a, {\n    href: \"#objects-removal\",\n    \"aria-label\": \"objects removal permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"The importance of each pixel (so-called pixel's energy) is being calculated based on its color (\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">R</code>\"\n    }\n  }), \", \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">G</code>\"\n    }\n  }), \", \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">B</code>\"\n    }\n  }), \", \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">A</code>\"\n    }\n  }), \") difference between two neighbor pixels. Now, if we set the pixel energy to some really low level artificially (i.e. by drawing a mask on top of them), the Seam Carving algorithm would perform an \", React.createElement(_components.strong, null, \"object removal\"), \" for us for free.\"), \"\\n\", React.createElement(_components.img, {\n    src: \"/posts-assets/b66335eb43b5d66231bd4025a043e0c0/10-demo-02.gif\",\n    alt: \"JS IMAGE CARVER OBJECT REMOVAL DEMO\"\n  }), \"\\n\", React.createElement(_components.h3, {\n    id: \"js-image-carver-demo\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"JS IMAGE CARVER demo\", React.createElement(_components.a, {\n    href: \"#js-image-carver-demo\",\n    \"aria-label\": \"js image carver demo permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"I've created the \", React.createElement(_components.a, {\n    href: \"https://trekhleb.dev/js-image-carver/\"\n  }, \"JS IMAGE CARVER\"), \" web-app (and also \", React.createElement(_components.a, {\n    href: \"https://github.com/trekhleb/js-image-carver\"\n  }, \"open-sourced it on GitHub\"), \") that you may use to play around with resizing of your custom images. You may also try its embed version below right away! This widget uses the Seam Carving algorithm that we're going to explore in this article.\"), \"\\n\", React.createElement(InteractivePostArea, {\n    title: \"Content Aware Image Resizer\"\n  }, React.createElement(ImageResizer, {\n    withSeam: true\n  })), \"\\n\", React.createElement(_components.h3, {\n    id: \"more-examples\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"More examples\", React.createElement(_components.a, {\n    href: \"#more-examples\",\n    \"aria-label\": \"more examples permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"Here are some more examples of how the algorithm copes with more complex backgrounds.\"), \"\\n\", React.createElement(_components.p, null, \"Mountains on the background are being shrunk smoothly without visible seams.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 915px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 27.599999999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABw0lEQVR42j3Q3UtTAQCG8fNXdNcntDPxKoigL5DVqAWm03IZ4lEvllMIbBurtrPRzMYIIgxFKpBSohBT2CLXcrVwko7m6mhLp4bOzI8mitaiqU8g5Xv98Lt4hZO3Jshzf+G4S+HgtSEK5U6OWl+TWxsk1+hHXdWFKHWw89xjXvR/5f/6k2sckpOckQPorncjGnu2OqGy4xdlT1cpbU9T1LqAoUWhoDnJqbsJtN6PaBqiaNwRDtuChD7N/eM2ic2uU/LkJxceTlDUPIL29jAadx+CN5GlYWSDGwo445vYohtYIhnM4RXqetNc7vmO6fkY0v1XxGaWt7jM2iqf07+pV7I44mCNZLC8XcHUmUAILU3SuzhOYHkG/3wK3/w03d+meDY6TNvQAO3xAVoHwzSFfIzOTrP+J0t68QdTS3MEUzH8Cym6UpM8+vCetlgEoeXmJR7IEk2yRKOjkju2cjzmcjxXynDWGrhqLKam4jyleh1978LbH44rg9wz62l0VOC1SLhqSrBXFyN4LorUG1TY9ftxFYo4zopUHdmN6cRerPk5GLU5nD6wj2OqHbx56dsGx6IB7Pm7cBaoMeXtoU6nolqr5i/IrVYYYEid7wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Resizing demo with more complex backgrounds\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/6675931650a00f92069f541b429f3854/4255a/11-demo-01.png\\\"\\n        srcset=\\\"/static/6675931650a00f92069f541b429f3854/63868/11-demo-01.png 250w,\\n/static/6675931650a00f92069f541b429f3854/0b533/11-demo-01.png 500w,\\n/static/6675931650a00f92069f541b429f3854/4255a/11-demo-01.png 915w\\\"\\n        sizes=\\\"(max-width: 915px) 100vw, 915px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"The same goes for the ocean waves. The algorithm preserved the wave structure without distorting the surfers.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 992px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 34.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVR42kXPz0vTcQDG8c8+3+93E+pQQXTodxcNaiJaM9YcosuGka1MmmyunJu65X65Hy5/TZtZ0YQCR2RESokdOoQESXUwgupWnqKD/Q2GbTv1LnfpOT+8Hh4hK48jG2woV7pRXL1ITwDZFUA6fSjuIDpPiIPpu1x9MM+TVytspVQssq/Djej0oXmC6LoG2JOY5trsM4Q8VovS0oZ0+ZH9ceT1IWR/EjUyhpqYQsSz2J6+ZPbNKkuv3/8HXT0If5SK6DhiMEvdw0XyKx8Qss6MtDtQA3G01CTa8BRqKovM3mf7zGPcz5d5t/aDz2vfWX77kT9bYKHAAW8Qmcign8hRnV9k6dNXVr98Qyg19eha29kVTbMzkkKXzKCOTqNm7iGGslzIzTGeX6A3O8PUo3k2fm3wc32dyr4Qu6NDiNE7HJrIMTn3Av/NHEKtPolmd2DwRzDERlCSE2gjt1CGp5F9cZrCN9h7sRNRZeRMIFS+/Htzk8MuL/pIGt3obapjY5i8AwiTBSGrjBhMp6lo60Dn9qF2B1F6BtDHxjAEkmw7dwm9pRlxwow9PFgGC8UCR9ouI53dVCQy7OgJo1ma0FttCHnUiKwxoZqtSGszSst5FKcXrTeOdLiQDc0YzI2I2npaYskyWCyV2G+zIxrPYtjqtbajnrKi/Rv+C3sALrarziVuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Resizing demo with more complex backgrounds\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/a029db0434320c3a8b95a09c4e01cc6c/91f10/11-demo-02.png\\\"\\n        srcset=\\\"/static/a029db0434320c3a8b95a09c4e01cc6c/63868/11-demo-02.png 250w,\\n/static/a029db0434320c3a8b95a09c4e01cc6c/0b533/11-demo-02.png 500w,\\n/static/a029db0434320c3a8b95a09c4e01cc6c/91f10/11-demo-02.png 992w\\\"\\n        sizes=\\\"(max-width: 992px) 100vw, 992px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"We need to keep in mind that the Seam Carving algorithm is not a silver bullet, and it may fail to resize the images where \", React.createElement(_components.em, null, \"most of the pixels are edges\"), \" (look important to the algorithm). In this case, it starts distorting even the important parts of the image. In the example below the content-aware image resizing looks pretty similar to a straightforward scaling since for the algorithm all the pixels look important, and it is hard for it to distinguish Van Gogh's face from the background.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 992px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 34.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8ElEQVR42gXByU4TcQDA4XkbY6IRwYal1VKwrdPW0lI7M+0M/06HbpTWgbIpgUAoSFG2BFBB4oULYMSL78AFwxBDPBgvJKwv8fP7JLdmEc3lqUzUsIolRsZsFmZHWJobYn15jI2NKcTwIB7FoDX6Cuf8DxdXNxiVQSrDVWanhliu27xrjBM0BJJXz+NWBcPVASZsi8lamsZ0gcakSX0gzpwtWHn/hrCZoflFBOf3ORfXtyRzRSbsLPVJi8Z4H/WaQClYSD7dpEO36FJ1ymaY1cUSux/KfPta42i7gq0HeDtSRK2UeOSX+eWccXl7hy+dodCfYGelwuHOa+aGFOKmQAqJLAGjj/aUIJOOsFcXHH4a5WC9ys8vNlvzJXqyGVqTGs1yhJPjY67//cUvshhGnP3VMt83qyxO5/EkVCSfotMtTNwpgV/2s1oK8WMtz9GKYLsmYw5aPI7rPIgqNPllHMfh8vIKn+gnHIuwN6Oxv6Ch5w1aYiqS3JclbBVoS6h4urqZ7XGxWw3ysejm85TGUyXNw1iKlt4UTYEwJ6cOVze3BM0coVCQLesZ2+NRvJpOa28K6aWRIZxUcLV14HK1M5rsZKPQyUFdZWltBq+WwxtTuf88wj2Pj9OzM27u7ggkVIJeD5tFH+vzZfx6jidylP+kpUHkpLfS5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Example when the algorithm does not work as expected\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/20b6b8dabb40b0dbc99656eae0108663/91f10/12-demo-01.png\\\"\\n        srcset=\\\"/static/20b6b8dabb40b0dbc99656eae0108663/63868/12-demo-01.png 250w,\\n/static/20b6b8dabb40b0dbc99656eae0108663/0b533/12-demo-01.png 500w,\\n/static/20b6b8dabb40b0dbc99656eae0108663/91f10/12-demo-01.png 992w\\\"\\n        sizes=\\\"(max-width: 992px) 100vw, 992px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.h2, {\n    id: \"how-seam-carving-algorithms-works\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"How Seam Carving algorithms works\", React.createElement(_components.a, {\n    href: \"#how-seam-carving-algorithms-works\",\n    \"aria-label\": \"how seam carving algorithms works permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"Imagine we have a \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">1000 x 500 px</code>\"\n    }\n  }), \" picture, and we want to change its size to \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">500 x 500 px</code>\"\n    }\n  }), \" to make it square (let's say the square ratio would better fit the Instagram feed). We might want to set up several \", React.createElement(_components.strong, null, \"requirements to the resizing process\"), \" in this case:\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.em, null, \"Preserve the important parts of the image\"), \" (i.e. if there were 5 trees before the resizing we want to have 5 trees after resizing as well).\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.em, null, \"Preserve the proportions\"), \" of the important parts of the image (i.e. circle car wheels should not be squeezed to the ellipse wheels)\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"To avoid changing the important parts of the image we may find the \", React.createElement(_components.strong, null, \"continuous sequence of pixels (the seam)\"), \", that goes from top to bottom and has \", React.createElement(_components.em, null, \"the lowest contribution to the content\"), \" of the image (avoids important parts) and then remove it. The seam removal will shrink the image by 1 pixel. We will then repeat this step until the image will get the desired width.\"), \"\\n\", React.createElement(_components.p, null, \"The question is how to define \", React.createElement(_components.em, null, \"the importance of the pixel\"), \" and its contribution to the content (in the original paper the authors are using the term \", React.createElement(_components.strong, null, \"energy of the pixel\"), \"). One of the ways to do it is to treat all the pixels that form the edges as important ones. In case if a pixel is a part of the edge its color would have a greater difference between the neighbors (left and right pixels) than the pixel that isn't a part of the edge.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 26.400000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVR42mWPr8rCcBSGf9mweRdu2KwGBxoUBGe32UQsS2owbsguY4LRGxisGMQsqKjJqoLiX9RHPDD54HvhhPNweF6OyuVyJJNJSqUS9XqdSqVCs9nEMAwSiQSe5xGn3+8LM02T0WjEZDJhOp1SrVaFW5aFSqVSKKXIZDIUCgXS6TS2baNpmvB2u/0TdrtdYbquEwQBYRgSRRHZbFb4t0g1Gg2KxSKO4+C6Lp1OB9/3qdVq5PN5BoPBTzgcDimXy/LJeDxmuVwym83o9XrCW60W6nq9cr/fOZ/PMsfjkcvlIux2u/F8Pvmb1+sl/HQ6cTgcZL57fK/e77cc7nY7NpsNq9WK7Xb7TxTLHo+HFC8WC+bzOev1mv1+L/zr+gDBByNntiyo+wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Pixels color difference\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/90983482f9c8f417893b5418a1d4b73d/00d43/30-pixel-energy-comparison.png\\\"\\n        srcset=\\\"/static/90983482f9c8f417893b5418a1d4b73d/63868/30-pixel-energy-comparison.png 250w,\\n/static/90983482f9c8f417893b5418a1d4b73d/0b533/30-pixel-energy-comparison.png 500w,\\n/static/90983482f9c8f417893b5418a1d4b73d/00d43/30-pixel-energy-comparison.png 1000w,\\n/static/90983482f9c8f417893b5418a1d4b73d/aa440/30-pixel-energy-comparison.png 1500w,\\n/static/90983482f9c8f417893b5418a1d4b73d/7e318/30-pixel-energy-comparison.png 1892w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Assuming that the color of a pixel is represented by \", React.createElement(_components.em, null, \"4\"), \" numbers (\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">R</code>\"\n    }\n  }), \" - red, \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">G</code>\"\n    }\n  }), \" - green, \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">B</code>\"\n    }\n  }), \" - blue, \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">A</code>\"\n    }\n  }), \" - alpha) we may use the following formula to calculate the color difference (the pixel energy):\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 6.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAABYlAAAWJQFJUiTwAAAANklEQVR42jWKyQkAQAwCt/9KcxNIAQYX8hCc0dfdYGYGqoqIgIigqmBmcPfvbiPTs/NDvmQmFurrS0CL0M9DAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Pixel energy formula\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/52d6bfaf3763a4964d244aa540fbc524/00d43/20-energy-formula.png\\\"\\n        srcset=\\\"/static/52d6bfaf3763a4964d244aa540fbc524/63868/20-energy-formula.png 250w,\\n/static/52d6bfaf3763a4964d244aa540fbc524/0b533/20-energy-formula.png 500w,\\n/static/52d6bfaf3763a4964d244aa540fbc524/00d43/20-energy-formula.png 1000w,\\n/static/52d6bfaf3763a4964d244aa540fbc524/5148a/20-energy-formula.png 1228w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Where:\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">mEnergy</code>\"\n    }\n  }), \" - \", React.createElement(_components.em, null, \"Energy\"), \" (importance) of the \", React.createElement(_components.em, null, \"middle\"), \" pixel (\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[0..626]</code>\"\n    }\n  }), \" if rounded)\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">lR</code>\"\n    }\n  }), \" - \", React.createElement(_components.em, null, \"Red\"), \" channel value for the \", React.createElement(_components.em, null, \"left\"), \" pixel (\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[0..255]</code>\"\n    }\n  }), \")\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">mR</code>\"\n    }\n  }), \" - \", React.createElement(_components.em, null, \"Red\"), \" channel value for the \", React.createElement(_components.em, null, \"middle\"), \" pixel (\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[0..255]</code>\"\n    }\n  }), \")\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">rR</code>\"\n    }\n  }), \" - \", React.createElement(_components.em, null, \"Red\"), \" channel value for the \", React.createElement(_components.em, null, \"right\"), \" pixel (\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[0..255]</code>\"\n    }\n  }), \")\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">lG</code>\"\n    }\n  }), \" - \", React.createElement(_components.em, null, \"Green\"), \" channel value for the \", React.createElement(_components.em, null, \"left\"), \" pixel (\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[0..255]</code>\"\n    }\n  }), \")\"), \"\\n\", React.createElement(_components.li, null, \"and so on...\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"In the formula above we're omitting the alpha (transparency) channel, for now, assuming that there are no transparent pixels in the image. Later we will use the alpha channel for masking and for object removal.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 64%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAABYlAAAWJQFJUiTwAAACKElEQVR42m1SbW/SUBTmL/kn/OyfMH7zD5gYjZ8wUYkuM+gyJlOyLWCDSNiYwW3MBdxAQCilpa9AgRa69ralb/ReA+gIuOfLPefe5zn3OScngOaYTqee57VaxJds9rJel2W50WjEMWwX+5z4mgKaxnFc5vQkVyz0+304B0IosBBDCKuVCtFmqeCbUXjrqlL+GItVzy5O7t4rbG4mM+n0Ubb5YoN6Hmq2KZZhFpLA4kAIsRRdnTDKUUKMF4qE8LNUdHzVehZiz5kySRfLJbS9Bx8Fh6raEYR1sdyRHtdfRuz9h4fo/vYg+ePgyfWrvDK4E0YbSe51PvTejj39hh7sSqM+vxQvIpZmzssXZeLy9IpO5cpbO+/Ch5Hj78dvE8XIp9RO5sMeGd8/44IH1V6HWxe7nmuZlqlPlNFwYmhAAyLfk4aSIonDgeharjk2bAsgaHvT6crAbkogCH3fN3QDAGCaxuwSIdtxTMMEAHieZzsOhP6Cv+xZ13UcxwWeJykSZ/HfrVqzSRMk22Nphmy1e22SJ0VRalEd5VpbsY0QMi1LokmbbOiKRFgUrVIcr4uy4/Q7Mt36Na7SOtXtGaXaSNPtuXjVNoI+9NyZKzgLrYnuOJZhWbbnzdz/h8Ba/nd3/q2dqmqKMoazej6c9+f7S8Zy2gghx3HS6XQ+n8/lcrVajSCIaDSKYZgsyzecW35ePNi2LQiCoigcx+E4DgBgGKbb7bqui27DH8sXvsB1BaYsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Example of pixel energy calculation\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/b2049638e4fd709f1225a7ee9aa2c9b5/00d43/30-pixel-energy-calculation-example.png\\\"\\n        srcset=\\\"/static/b2049638e4fd709f1225a7ee9aa2c9b5/63868/30-pixel-energy-calculation-example.png 250w,\\n/static/b2049638e4fd709f1225a7ee9aa2c9b5/0b533/30-pixel-energy-calculation-example.png 500w,\\n/static/b2049638e4fd709f1225a7ee9aa2c9b5/00d43/30-pixel-energy-calculation-example.png 1000w,\\n/static/b2049638e4fd709f1225a7ee9aa2c9b5/c83ae/30-pixel-energy-calculation-example.png 1180w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Now, since we know how to find the energy of one pixel, we can calculate, so-called, \", React.createElement(_components.strong, null, \"energy map\"), \" which will contain the energies of each pixel of the image. On each resizing step the energy map should be re-calculated (at least partially, more about it below) and would have the same size as the image.\"), \"\\n\", React.createElement(_components.p, null, \"For example, on the 1st resizing step we will have a \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">1000 x 500</code>\"\n    }\n  }), \" image and a \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">1000 x 500</code>\"\n    }\n  }), \" energy map. On the 2nd resizing step we will remove the seam from the image and re-calculate the energy map based on the new shrunk image. Thus, we will get a \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">999 x 500</code>\"\n    }\n  }), \" image and a \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">999 x 500</code>\"\n    }\n  }), \" energy map.\"), \"\\n\", React.createElement(_components.p, null, \"The higher the energy of the pixel the more likely it is a part of an edge, and it is important for the image content and the less likely that we need to remove it.\"), \"\\n\", React.createElement(_components.p, null, \"To visualize the energy map we may assign a brighter color to the pixels with the higher energy and darker colors to the pixels with the lower energy. Here is an artificial example of how the random part of the energy map might look like. You may see the bright line which represents the edge and which we want to preserve during the resizing.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABfElEQVR42o2SzcsBURSH/X/2xsJKmZJmNkryla9iI6XxsSJZWLASomhGoZQtG2VjZcPMCJOvn+4pb7x53+Zu7jn3dp977nOuBV/G9XrF4/HA5XKh+Hw+U75arTCbzbBer7HZbGjt97C8gtfm4XCALMuYz+cYj8c0s5yBKpUKqtUqEokEUqkUNE37OPsBfN9oNBoIhUKw2+0QBAE2mw1WqxVOpxPFYhHZbBblchmqqpoDdrtd5PN5iKKIcDiMaDRKgFgsBo/HQ3mpVMJ+vzcHHI1GqNVqSKfTKBQKqNfrGA6HkCQJDocDkUgE7XYbt9vtb4fvwFarhUwmQ1UEAgHy1ev1kEwm4fP5EI/HyeXpdDIH7Pf7yOVyJJ/jOLjd7h84A/r9frrQMAxzwMlkgmAwSE1gTXG5XARgTpk/r9dLOo7H4/8O7/c7zc1mEzzPU5WLxYIULJdLdDodKIpCzx8MBvTFTFW43W4xnU7p87JLdF2nddZVBtntdhR/e/ITggexLNe9JSkAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Energy map sketch\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/5e808e4fa89d56fdc670123dc6f87dbc/00d43/30-energy-map-padding.png\\\"\\n        srcset=\\\"/static/5e808e4fa89d56fdc670123dc6f87dbc/63868/30-energy-map-padding.png 250w,\\n/static/5e808e4fa89d56fdc670123dc6f87dbc/0b533/30-energy-map-padding.png 500w,\\n/static/5e808e4fa89d56fdc670123dc6f87dbc/00d43/30-energy-map-padding.png 1000w,\\n/static/5e808e4fa89d56fdc670123dc6f87dbc/2cefc/30-energy-map-padding.png 1400w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Here is a real example of the energy map for the demo image you saw above (with hot air balloons).\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 47.599999999999994%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABAklEQVR42o2S2Y6EUAhEr/uu7a6J//+bTA5JmdtPPQ+IFFCUYAghGJZlmXVdZ2mamrDYkiRx+4WFpmmcrKoqu67LiqJ4i/HEZVl6btu2r9y+73bf9zchQN/3XpTnuXtUSilNz/PYNE3Wtq3nGQKOgYMhynt4aCIqUQNGARhDRCQjvyyL10rxK4LHOI6e+Hw+TspUGuI9/deCPmEYBjuOw+q6dkK8jjXP86sYQ5ni+DDu+SQC9riu67vHuAjV8TVRr4Hxuvyg8W8SE3F9NWHxrlULgTDW5jsFIFBS18KjFlL9VsJoPM/TlRLTiwAXxwVpIgGA1wAVS6Ew3iGVCNbFQNT/AarC0sdjq27NAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Energy map example\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/1659c5586b7689dfc225632d20df874c/00d43/40-energy-map.png\\\"\\n        srcset=\\\"/static/1659c5586b7689dfc225632d20df874c/63868/40-energy-map.png 250w,\\n/static/1659c5586b7689dfc225632d20df874c/0b533/40-energy-map.png 500w,\\n/static/1659c5586b7689dfc225632d20df874c/00d43/40-energy-map.png 1000w,\\n/static/1659c5586b7689dfc225632d20df874c/aa440/40-energy-map.png 1500w,\\n/static/1659c5586b7689dfc225632d20df874c/0ef7e/40-energy-map.png 1594w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"The widget below renders the energy map during resizing. You may play around with your custom images and see how the energy map would look like.\"), \"\\n\", React.createElement(InteractivePostArea, {\n    title: \"Content Aware Image Resizer with Energy Map\"\n  }, React.createElement(ImageResizer, {\n    withSeam: true,\n    withEnergyMap: true\n  })), \"\\n\", React.createElement(_components.p, null, \"We may use the energy map to find the seams (one after another) with the lowest energy and by doing this to decide which pixels should be ultimately deleted.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 35.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABjElEQVR42j2RbWviQBSF/f9/oRUKLf1QCJZKa6mFRddkHBMnJsYaX0qSDaQxq4IWLJbgsziuvR/PPfPce+ZWptMpvu/jeh5+o4HfapFmGcfKbBvv9ZVBEOAqRRiGWl+mKcHTE8PRCM/z2O12nKsSBAF9x0Eohbq+xq7VmLy/6+aflxccw0Aqhex2sW37NGg8xrm4wHFdTNNks9lo/XA4UHFdF0sIZK2GNAysVov5fM5XWTJ7fEQYBu1eD6vTQSlFCSTDIbJaRToOlmWxXq/Z7/cnoJQS07IwHx7o3N5iNpuEkwnbz09GUtK+uqJdr/PLNLGlZLffE3se3ctLflsWQgiyLGO73Z6Ax6mObdMdDBjc3ODX60zj+Lg/8yRBNpv07+7oNRoo19XR8vEYt1rFVkoDj7CfyFEUEccxUZIQCUEoJcVqdXr48UGcZUylxHt+1p7zUfr397yFIV0hWP33a+Axe1EU/C0Klus1WZ5TlqU26N5iwWK5JEpTHU3r398kacpsNiPPc/2H5yv/A+BB8Q9xAdABAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Searching the seam\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/39d3463cadde3652c70ec053af5df8c3/00d43/41-seam-search.png\\\"\\n        srcset=\\\"/static/39d3463cadde3652c70ec053af5df8c3/63868/41-seam-search.png 250w,\\n/static/39d3463cadde3652c70ec053af5df8c3/0b533/41-seam-search.png 500w,\\n/static/39d3463cadde3652c70ec053af5df8c3/00d43/41-seam-search.png 1000w,\\n/static/39d3463cadde3652c70ec053af5df8c3/aa440/41-seam-search.png 1500w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Finding the seam with the lowest energy is not a trivial task and requires exploring many possible pixel combinations before making the decision. We will apply the dynamic programming approach to speed it up.\"), \"\\n\", React.createElement(_components.p, null, \"In the example below, you may see the energy map with the first lowest energy seam that was found for it.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 47.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA+ElEQVR42l2SyXLAMAhDnX3fl8kpl/z/N9J5dORxeyDGQggwCSEEkzVNY/u+Rz/P8xjD77rOsiyLWFmW1ratpRoBIiII1HXtPkmQwfDBsPd9HQcrisKO47Dv+/wuC3zmeXYxKnCnCCfV8Z/ncQ4iGLz7vm3bNr/DkQUpUxniuq5WVZUNw2DTNMUCGl8jw5H4nw4BCJDMiMuyuPh1Xd6Vkomlyf+FIp5W500YhfFlFEOMjvXwLIfCqWjUgazW0zGwvu/jFtPtkgg3xcdxFPcX1Eb1BJwQ6IxkRMTBBz/PMwpT3PeAw2iMoC1yB1ei/gDFESEujt6fCX4Alhi+Y3u7KcMAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Energy map example with seam\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/d7d501caeaed73919661a8d639863e43/00d43/40-energy-map-with-seam.png\\\"\\n        srcset=\\\"/static/d7d501caeaed73919661a8d639863e43/63868/40-energy-map-with-seam.png 250w,\\n/static/d7d501caeaed73919661a8d639863e43/0b533/40-energy-map-with-seam.png 500w,\\n/static/d7d501caeaed73919661a8d639863e43/00d43/40-energy-map-with-seam.png 1000w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"In the examples above we were reducing the width of the image. A similar approach may be taken to reduce the image height. We need to \\\"rotate\\\" the approach though:\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"start using \", React.createElement(_components.em, null, \"top\"), \" and \", React.createElement(_components.em, null, \"bottom\"), \" pixel neighbors (instead of \", React.createElement(_components.em, null, \"left\"), \" and \", React.createElement(_components.em, null, \"right\"), \" ones) to calculate the pixel energy\"), \"\\n\", React.createElement(_components.li, null, \"when searching for a seam we need to move from \", React.createElement(_components.em, null, \"left\"), \" to \", React.createElement(_components.em, null, \"right\"), \" (instead of from \", React.createElement(_components.em, null, \"up\"), \" to \", React.createElement(_components.em, null, \"bottom\"), \")\"), \"\\n\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"implementation-in-typescript\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Implementation in TypeScript\", React.createElement(_components.a, {\n    href: \"#implementation-in-typescript\",\n    \"aria-label\": \"implementation in typescript permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.blockquote, null, \"\\n\", React.createElement(_components.p, null, \"You may find the source code, and the functions mentioned below in the \", React.createElement(_components.a, {\n    href: \"https://github.com/trekhleb/js-image-carver\"\n  }, \"js-image-carver\"), \" repository.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"To implement the algorithm we will be using TypeScript. If you want a JavaScript version, you may ignore (remove) type definitions and their usages.\"), \"\\n\", React.createElement(_components.p, null, \"For simplicity reasons let's implement the seam carving algorithm only for the image \", React.createElement(_components.em, null, \"width\"), \" reduction.\"), \"\\n\", React.createElement(_components.h3, {\n    id: \"content-aware-width-resizing-the-entry-function\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Content-aware width resizing (the entry function)\", React.createElement(_components.a, {\n    href: \"#content-aware-width-resizing-the-entry-function\",\n    \"aria-label\": \"content aware width resizing the entry function permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"First, let's define some common types that we're going to use while implementing the algorithm.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"typescript\\\"><pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// Type that describes the image size (width and height).</span>\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token class-name\\\">ImageSize</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span> w<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> h<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">// The coordinate of the pixel.</span>\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token class-name\\\">Coordinate</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">// The seam is a sequence of pixels (coordinates).</span>\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token class-name\\\">Seam</span> <span class=\\\"token operator\\\">=</span> Coordinate<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">// Energy map is a 2D array that has the same width and height</span>\\n<span class=\\\"token comment\\\">// as the image the map is being calculated for.</span>\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token class-name\\\">EnergyMap</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">// Type that describes the image pixel's RGBA color.</span>\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token class-name\\\">Color</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span>\\n  r<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Red</span>\\n  g<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Green</span>\\n  b<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Blue</span>\\n  a<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Alpha (transparency)</span>\\n<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">|</span> Uint8ClampedArray<span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"On the high level the algorithm consists of the following steps:\"), \"\\n\", React.createElement(_components.ol, null, \"\\n\", React.createElement(_components.li, null, \"Calculate the \", React.createElement(_components.strong, null, \"energy map\"), \" for the current version of the image.\"), \"\\n\", React.createElement(_components.li, null, \"Find the \", React.createElement(_components.strong, null, \"seam\"), \" with the lowest energy based on the energy map (this is where we will apply Dynamic Programming).\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"Delete the seam\"), \" with the lowest energy seam from the image.\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"Repeat\"), \" until the image width is reduced to the desired value.\"), \"\\n\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"typescript\\\"><pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token keyword\\\">type</span> <span class=\\\"token class-name\\\">ResizeImageWidthArgs</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  img<span class=\\\"token operator\\\">:</span> ImageData<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Image data we want to resize.</span>\\n  toWidth<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Final image width we want the image to shrink to.</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token class-name\\\">ResizeImageWidthResult</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  img<span class=\\\"token operator\\\">:</span> ImageData<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Resized image data.</span>\\n  size<span class=\\\"token operator\\\">:</span> ImageSize<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// Resized image size (w x h).</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">// Performs the content-aware image width resizing using the seam carving method.</span>\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">const</span> resizeImageWidth <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token punctuation\\\">{</span> img<span class=\\\"token punctuation\\\">,</span> toWidth <span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">:</span> ResizeImageWidthArgs<span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> ResizeImageWidthResult <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// For performance reasons we want to avoid changing the img data array size.</span>\\n  <span class=\\\"token comment\\\">// Instead we'll just keep the record of the resized image width and height separately.</span>\\n  <span class=\\\"token keyword\\\">const</span> size<span class=\\\"token operator\\\">:</span> ImageSize <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span> w<span class=\\\"token operator\\\">:</span> img<span class=\\\"token punctuation\\\">.</span>width<span class=\\\"token punctuation\\\">,</span> h<span class=\\\"token operator\\\">:</span> img<span class=\\\"token punctuation\\\">.</span>height <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token comment\\\">// Calculating the number of pixels to remove.</span>\\n  <span class=\\\"token keyword\\\">const</span> pxToRemove <span class=\\\"token operator\\\">=</span> img<span class=\\\"token punctuation\\\">.</span>width <span class=\\\"token operator\\\">-</span> toWidth<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>pxToRemove <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Error</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Upsizing is not supported for now'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token keyword\\\">let</span> energyMap<span class=\\\"token operator\\\">:</span> EnergyMap <span class=\\\"token operator\\\">|</span> <span class=\\\"token keyword\\\">null</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">let</span> seam<span class=\\\"token operator\\\">:</span> Seam <span class=\\\"token operator\\\">|</span> <span class=\\\"token keyword\\\">null</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token comment\\\">// Removing the lowest energy seams one by one.</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> i <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;</span> pxToRemove<span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">// 1. Calculate the energy map for the current version of the image.</span>\\n    energyMap <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">calculateEnergyMap</span><span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> size<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token comment\\\">// 2. Find the seam with the lowest energy based on the energy map.</span>\\n    seam <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">findLowEnergySeam</span><span class=\\\"token punctuation\\\">(</span>energyMap<span class=\\\"token punctuation\\\">,</span> size<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token comment\\\">// 3. Delete the seam with the lowest energy seam from the image.</span>\\n    <span class=\\\"token function\\\">deleteSeam</span><span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> seam<span class=\\\"token punctuation\\\">,</span> size<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token comment\\\">// Reduce the image width, and continue iterations.</span>\\n    size<span class=\\\"token punctuation\\\">.</span>w <span class=\\\"token operator\\\">-=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token comment\\\">// Returning the resized image and its final size.</span>\\n  <span class=\\\"token comment\\\">// The img is actually a reference to the ImageData, so technically</span>\\n  <span class=\\\"token comment\\\">// the caller of the function already has this pointer. But let's</span>\\n  <span class=\\\"token comment\\\">// still return it for better code readability.</span>\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">{</span> img<span class=\\\"token punctuation\\\">,</span> size <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"The image that needs to be resized is being passed to the function in \", React.createElement(_components.a, {\n    href: \"https://developer.mozilla.org/en-US/docs/Web/API/ImageData\"\n  }, \"ImageData\"), \" format. You may draw the image on the canvas and then extract the ImageData from the canvas like this:\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"javascript\\\"><pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">const</span> ctx <span class=\\\"token operator\\\">=</span> canvas<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getContext</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'2d'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">const</span> imgData <span class=\\\"token operator\\\">=</span> ctx<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getImageData</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> imgWidth<span class=\\\"token punctuation\\\">,</span> imgHeight<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.blockquote, null, \"\\n\", React.createElement(_components.p, null, \"The way of uploading and drawing images in JavaScript is out of scope for this article, but you may find the complete source code of how it may be done using React in \", React.createElement(_components.a, {\n    href: \"https://github.com/trekhleb/js-image-carver\"\n  }, \"js-image-carver\"), \" repo.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Let's break down each step ony be one and implement the \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">calculateEnergyMap()</code>\"\n    }\n  }), \", \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">findLowEnergySeam()</code>\"\n    }\n  }), \" and \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">deleteSeam()</code>\"\n    }\n  }), \" functions.\"), \"\\n\", React.createElement(_components.h3, {\n    id: \"calculating-the-pixels-energy\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Calculating the pixel's energy\", React.createElement(_components.a, {\n    href: \"#calculating-the-pixels-energy\",\n    \"aria-label\": \"calculating the pixels energy permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"Here we apply the color difference formula described above. For the left and right borders (when there are no left or right neighbors), we ignore the neighbors and don't take them into account during the energy calculation.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"typescript\\\"><pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// Calculates the energy of a pixel.</span>\\n<span class=\\\"token keyword\\\">const</span> getPixelEnergy <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>left<span class=\\\"token operator\\\">:</span> Color <span class=\\\"token operator\\\">|</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span> middle<span class=\\\"token operator\\\">:</span> Color<span class=\\\"token punctuation\\\">,</span> right<span class=\\\"token operator\\\">:</span> Color <span class=\\\"token operator\\\">|</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// Middle pixel is the pixel we're calculating the energy for.</span>\\n  <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">[</span>mR<span class=\\\"token punctuation\\\">,</span> mG<span class=\\\"token punctuation\\\">,</span> mB<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> middle<span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token comment\\\">// Energy from the left pixel (if it exists).</span>\\n  <span class=\\\"token keyword\\\">let</span> lEnergy <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>left<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">[</span>lR<span class=\\\"token punctuation\\\">,</span> lG<span class=\\\"token punctuation\\\">,</span> lB<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> left<span class=\\\"token punctuation\\\">;</span>\\n    lEnergy <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>lR <span class=\\\"token operator\\\">-</span> mR<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token punctuation\\\">(</span>lG <span class=\\\"token operator\\\">-</span> mG<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token punctuation\\\">(</span>lB <span class=\\\"token operator\\\">-</span> mB<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token comment\\\">// Energy from the right pixel (if it exists).</span>\\n  <span class=\\\"token keyword\\\">let</span> rEnergy <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>right<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">[</span>rR<span class=\\\"token punctuation\\\">,</span> rG<span class=\\\"token punctuation\\\">,</span> rB<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> right<span class=\\\"token punctuation\\\">;</span>\\n    rEnergy <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>rR <span class=\\\"token operator\\\">-</span> mR<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token punctuation\\\">(</span>rG <span class=\\\"token operator\\\">-</span> mG<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token punctuation\\\">(</span>rB <span class=\\\"token operator\\\">-</span> mB<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token comment\\\">// Resulting pixel energy.</span>\\n  <span class=\\\"token keyword\\\">return</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">sqrt</span><span class=\\\"token punctuation\\\">(</span>lEnergy <span class=\\\"token operator\\\">+</span> rEnergy<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.h3, {\n    id: \"calculating-the-energy-map\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Calculating the energy map\", React.createElement(_components.a, {\n    href: \"#calculating-the-energy-map\",\n    \"aria-label\": \"calculating the energy map permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"The image we're working with has the \", React.createElement(_components.a, {\n    href: \"https://developer.mozilla.org/en-US/docs/Web/API/ImageData\"\n  }, \"ImageData\"), \" format. It means that all the pixels (and their colors) are stored in a flat (\", React.createElement(_components.em, null, \"1D\"), \") \", React.createElement(_components.a, {\n    href: \"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray\"\n  }, \"Uint8ClampedArray\"), \" array. For readability purposes let's introduce the couple of helper functions that will allow us to work with the Uint8ClampedArray array as with a \", React.createElement(_components.em, null, \"2D\"), \" matrix instead.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"typescript\\\"><pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// Helper function that returns the color of the pixel.</span>\\n<span class=\\\"token keyword\\\">const</span> getPixel <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token operator\\\">:</span> ImageData<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token punctuation\\\">,</span> y <span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">:</span> Coordinate<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Color <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// The ImageData data array is a flat 1D array.</span>\\n  <span class=\\\"token comment\\\">// Thus we need to convert x and y coordinates to the linear index.</span>\\n  <span class=\\\"token keyword\\\">const</span> i <span class=\\\"token operator\\\">=</span> y <span class=\\\"token operator\\\">*</span> img<span class=\\\"token punctuation\\\">.</span>width <span class=\\\"token operator\\\">+</span> x<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">const</span> cellsPerColor <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">4</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// RGBA</span>\\n  <span class=\\\"token comment\\\">// For better efficiency, instead of creating a new sub-array we return</span>\\n  <span class=\\\"token comment\\\">// a pointer to the part of the ImageData array.</span>\\n  <span class=\\\"token keyword\\\">return</span> img<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">subarray</span><span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token operator\\\">*</span> cellsPerColor<span class=\\\"token punctuation\\\">,</span> i <span class=\\\"token operator\\\">*</span> cellsPerColor <span class=\\\"token operator\\\">+</span> cellsPerColor<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">// Helper function that sets the color of the pixel.</span>\\n<span class=\\\"token keyword\\\">const</span> setPixel <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token operator\\\">:</span> ImageData<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token punctuation\\\">,</span> y <span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">:</span> Coordinate<span class=\\\"token punctuation\\\">,</span> color<span class=\\\"token operator\\\">:</span> Color<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// The ImageData data array is a flat 1D array.</span>\\n  <span class=\\\"token comment\\\">// Thus we need to convert x and y coordinates to the linear index.</span>\\n  <span class=\\\"token keyword\\\">const</span> i <span class=\\\"token operator\\\">=</span> y <span class=\\\"token operator\\\">*</span> img<span class=\\\"token punctuation\\\">.</span>width <span class=\\\"token operator\\\">+</span> x<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">const</span> cellsPerColor <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">4</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// RGBA</span>\\n  img<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">set</span><span class=\\\"token punctuation\\\">(</span>color<span class=\\\"token punctuation\\\">,</span> i <span class=\\\"token operator\\\">*</span> cellsPerColor<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"To calculate the energy map we go through each image pixel and call the previously described \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">getPixelEnergy()</code>\"\n    }\n  }), \" function against it.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"typescript\\\"><pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// Helper function that creates a matrix (2D array) of specific</span>\\n<span class=\\\"token comment\\\">// size (w x h) and fills it with specified value.</span>\\n<span class=\\\"token keyword\\\">const</span> matrix <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token constant\\\">T</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">(</span>w<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> h<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> filler<span class=\\\"token operator\\\">:</span> <span class=\\\"token constant\\\">T</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token constant\\\">T</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\"><span class=\\\"token builtin\\\">Array</span></span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">fill</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">map</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\"><span class=\\\"token builtin\\\">Array</span></span><span class=\\\"token punctuation\\\">(</span>w<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">fill</span><span class=\\\"token punctuation\\\">(</span>filler<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">// Calculates the energy of each pixel of the image.</span>\\n<span class=\\\"token keyword\\\">const</span> calculateEnergyMap <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token operator\\\">:</span> ImageData<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> w<span class=\\\"token punctuation\\\">,</span> h <span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">:</span> ImageSize<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> EnergyMap <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// Create an empty energy map where each pixel has infinitely high energy.</span>\\n  <span class=\\\"token comment\\\">// We will update the energy of each pixel.</span>\\n  <span class=\\\"token keyword\\\">const</span> energyMap<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token generic-function\\\"><span class=\\\"token function\\\">matrix</span><span class=\\\"token generic class-name\\\"><span class=\\\"token operator\\\">&lt;</span><span class=\\\"token builtin\\\">number</span><span class=\\\"token operator\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span>w<span class=\\\"token punctuation\\\">,</span> h<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">Infinity</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> y <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> y <span class=\\\"token operator\\\">&lt;</span> h<span class=\\\"token punctuation\\\">;</span> y <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> x <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">&lt;</span> w<span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token comment\\\">// Left pixel might not exist if we're on the very left edge of the image.</span>\\n      <span class=\\\"token keyword\\\">const</span> left <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">>=</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">?</span> <span class=\\\"token function\\\">getPixel</span><span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token operator\\\">:</span> x <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> y <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token comment\\\">// The color of the middle pixel that we're calculating the energy for.</span>\\n      <span class=\\\"token keyword\\\">const</span> middle <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getPixel</span><span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token punctuation\\\">,</span> y <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token comment\\\">// Right pixel might not exist if we're on the very right edge of the image.</span>\\n      <span class=\\\"token keyword\\\">const</span> right <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&lt;</span> w <span class=\\\"token operator\\\">?</span> <span class=\\\"token function\\\">getPixel</span><span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token operator\\\">:</span> x <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> y <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n      energyMap<span class=\\\"token punctuation\\\">[</span>y<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>x<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getPixelEnergy</span><span class=\\\"token punctuation\\\">(</span>left<span class=\\\"token punctuation\\\">,</span> middle<span class=\\\"token punctuation\\\">,</span> right<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token keyword\\\">return</span> energyMap<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.blockquote, null, \"\\n\", React.createElement(_components.p, null, \"The energy map is going to be recalculated on every resize iteration. It means that it will be recalculated, let's say, 500 times if we need to shrink the image by 500 pixels which is not optimal. To speed up the energy map calculation on the 2nd, 3rd, and further steps, we may re-calculate the energy only for those pixels that are placed around the seam that is going to be removed. For simplicity reasons this optimization is omitted here, but you may find the example source-code in \", React.createElement(_components.a, {\n    href: \"https://github.com/trekhleb/js-image-carver\"\n  }, \"js-image-carver\"), \" repo.\"), \"\\n\"), \"\\n\", React.createElement(_components.h3, {\n    id: \"finding-the-seam-with-the-lowest-energy-dynamic-programming-approach\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Finding the seam with the lowest energy (Dynamic Programming approach)\", React.createElement(_components.a, {\n    href: \"#finding-the-seam-with-the-lowest-energy-dynamic-programming-approach\",\n    \"aria-label\": \"finding the seam with the lowest energy dynamic programming approach permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.blockquote, null, \"\\n\", React.createElement(_components.p, null, \"I've described some Dynamic Programming basics in \", React.createElement(_components.a, {\n    href: \"https://trekhleb.dev/blog/2018/dynamic-programming-vs-divide-and-conquer/\"\n  }, \"Dynamic Programming vs Divide-and-Conquer\"), \" article before. There is a DP example based on the minimum edit distance problem. You might want to check it out to get some more context.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"The issue we need to solve now is to find the path (the seam) on the energy map that goes from top to bottom and has the minimum sum of pixel energies.\"), \"\\n\", React.createElement(_components.h4, {\n    id: \"the-naive-approach\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"The naive approach\", React.createElement(_components.a, {\n    href: \"#the-naive-approach\",\n    \"aria-label\": \"the naive approach permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"The naive approach would be to check all possible paths one after another.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 21.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA+0lEQVR42j2Pa2uCYACF+///ZLDFYGsXWVupr6avTs3SssvKli13ZYswFJ5Rox04cM758MCpteQES3o40mKWLmmaA2zbJuqHROOMpgjohQGjZIDsZ2iGg+85jCZz7owYx5F0u1222y171RrtCN2wMYTGeJpSVzxUtY3vPRIOZpw2BJ2OSRh4GP4TFzcaQleJh2Pqty4PrTa2bfGz2fwBFRGjiQ6G0EnTBdctD+VeJ/Bc4mTOuWIhpSTq9xiOppxcmpimSZIMUYXD2ZWB47psjsBs9UJRFFRVdRjW+Stv7x+H/Pn1TZ7nlGV58P7W4nn536uqJFutKXY7jvoFVZAbvCNbOdoAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"The naive approach\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/3e3d5e01a68a349e69a9a3cc734fabb5/00d43/50-naive-approach.png\\\"\\n        srcset=\\\"/static/3e3d5e01a68a349e69a9a3cc734fabb5/63868/50-naive-approach.png 250w,\\n/static/3e3d5e01a68a349e69a9a3cc734fabb5/0b533/50-naive-approach.png 500w,\\n/static/3e3d5e01a68a349e69a9a3cc734fabb5/00d43/50-naive-approach.png 1000w,\\n/static/3e3d5e01a68a349e69a9a3cc734fabb5/aa440/50-naive-approach.png 1500w,\\n/static/3e3d5e01a68a349e69a9a3cc734fabb5/e8950/50-naive-approach.png 2000w,\\n/static/3e3d5e01a68a349e69a9a3cc734fabb5/c6162/50-naive-approach.png 2166w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Going from top to bottom, for each pixel, we have 3 options ( go down-left,  go down,  go down-right). This gives us the time complexity of \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">O(w * 3^h)</code>\"\n    }\n  }), \" or simply \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">O(3^h)</code>\"\n    }\n  }), \", where \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">w</code>\"\n    }\n  }), \" and \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">h</code>\"\n    }\n  }), \" are the width and the height of the image. This approach looks slow.\"), \"\\n\", React.createElement(_components.h4, {\n    id: \"the-greedy-approach\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"The greedy approach\", React.createElement(_components.a, {\n    href: \"#the-greedy-approach\",\n    \"aria-label\": \"the greedy approach permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"We may also try to choose the next pixel as a pixel with the lowest energy, hoping that the resulting seam energy will be the smallest one.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 46.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPElEQVR42p2Py07CUABE+V93Lt3rR2hko0YwMfEJ0VpRKqKi+KqhFCioUQTaWkvB0t5yjLr0kcAks5nFyZkYv2QYCW70JkW1Rq1aQa+UONdSaLqKaVr8l9hvYxQOSOyWWdrIkz9SyOZk4tIE0sEGtaoxOlCEPuvKI6lsGfW2yIWaY/tyhsKVQqN+P4ahCFjYvGRxNceWFGcxM4W0JyHLMoYxhmEYhpycFZldlplLSuxkFkjK06R31yhr+ujAwSCgopfYV85IbJ6znM6xcjrJ4XFqvMufhvVGA6OqUSiWWNm75vBuniu1QKvVQUQBQgSIKPwfGA2HiOi7QRB+gW2nj2n5dL1XLOeFN8/E7Vl0ezZOt00Q+n8DO/aAh+d3mi0f2wlwPYHjCoQQOF4b221iOk947w59v0vPd39YfgAocKfxReESTwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"The greedy approach\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/3ef6b22f08627ca3e0e47d70b53e5a19/00d43/51-greedy-approach.png\\\"\\n        srcset=\\\"/static/3ef6b22f08627ca3e0e47d70b53e5a19/63868/51-greedy-approach.png 250w,\\n/static/3ef6b22f08627ca3e0e47d70b53e5a19/0b533/51-greedy-approach.png 500w,\\n/static/3ef6b22f08627ca3e0e47d70b53e5a19/00d43/51-greedy-approach.png 1000w,\\n/static/3ef6b22f08627ca3e0e47d70b53e5a19/105d8/51-greedy-approach.png 1170w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"This approach gives not the worst solution, but it cannot guarantee that we will find the best available solution. On the image above you may see how the greedy approach chose \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">5</code>\"\n    }\n  }), \" instead of \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">10</code>\"\n    }\n  }), \" at first and missed the chain of optimal pixels.\"), \"\\n\", React.createElement(_components.p, null, \"The good part about this approach is that it is fast, and it has a time complexity of \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">O(w + h)</code>\"\n    }\n  }), \", where \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">w</code>\"\n    }\n  }), \" and \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">h</code>\"\n    }\n  }), \" are the width and the height of the image. In this case, the cost of the speed is the low quality of resizing. We need to find a minimum value in the first row (traversing \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">w</code>\"\n    }\n  }), \" cells) and then we explore only 3 neighbor pixels for each row (traversing \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">h</code>\"\n    }\n  }), \" rows).\"), \"\\n\", React.createElement(_components.h4, {\n    id: \"the-dynamic-programming-approach\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"The dynamic programming approach\", React.createElement(_components.a, {\n    href: \"#the-dynamic-programming-approach\",\n    \"aria-label\": \"the dynamic programming approach permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"You might have noticed that in the naive approach we summed up the same pixel energies over and over again while calculating the resulting seams' energy.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 39.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABi0lEQVR42n2S627aQBCF8/6vUlWVUkV1S6gM2IBtQkvaJmBIL/jGJY5je8HBePerMP0BUtSRRquZWZ05c2YuOJhS9SPTDDn3Ues1KkmQqzUySVCPj6iiACmP/h+7OIs2G2SWIcsSWWyReY7KUmRRUAlBdajnAiUypFJIKWt/HVBKZpbL/fCW2c8H7sZj0jjGtSZMbr8zmU1xZzOy+Ilxa8T07h536uJOJmy32xNABfXA1Z5rbcTnqwbOwEHXdRZzj+bHb7S0BoZp0Ol0iLwQ7XKIbXTo9fuYhkGSJP+UU0eGR8CKtjbEbOjcfBlidruswwhdG/HVMOvcYDDgabnC0Wx0vV83tiyLNE3PAY8jVzSubrj+0MRxbFrtNpHvYTcd3r5rYnbNmo3vB1x+snnzvkWva9b/zhkexC1L9tWeH1OfP15AHMcsFws2IieMFvSGLlEUEYUhWS6wRw/43pwwDAmCgN1ud6JhUVCuVgixIQx8Xl6KY0UI9skzSZoy//3rZHeS5SKiLMtXz+YvUkJTTgeorT4AAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Repeated problems\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/74feb3576570af5c327322a61a404cd6/00d43/52-dp-repeated-problems.png\\\"\\n        srcset=\\\"/static/74feb3576570af5c327322a61a404cd6/63868/52-dp-repeated-problems.png 250w,\\n/static/74feb3576570af5c327322a61a404cd6/0b533/52-dp-repeated-problems.png 500w,\\n/static/74feb3576570af5c327322a61a404cd6/00d43/52-dp-repeated-problems.png 1000w,\\n/static/74feb3576570af5c327322a61a404cd6/aa440/52-dp-repeated-problems.png 1500w,\\n/static/74feb3576570af5c327322a61a404cd6/019a6/52-dp-repeated-problems.png 1818w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"In the example above you see that for the first two seams we are re-using the energy of the shorter seam (which has the energy of \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">235</code>\"\n    }\n  }), \"). Instead of doing just one operation \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">235 + 70</code>\"\n    }\n  }), \" to calculate the energy of the 2nd seam we're doing four operations \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">(5 + 0 + 80 + 150) + 70</code>\"\n    }\n  }), \".\"), \"\\n\", React.createElement(_components.blockquote, null, \"\\n\", React.createElement(_components.p, null, \"This fact that we're re-using the energy of the previous seam to calculate the current seam's energy might be applied recursively to all the shorter seams up to the very top 1st row seam. When we have such overlapping sub-problems, \", React.createElement(_components.a, {\n    href: \"https://trekhleb.dev/blog/2018/dynamic-programming-vs-divide-and-conquer/\"\n  }, \"it is a sign\"), \" that the general problem \", React.createElement(_components.em, null, \"might\"), \" be optimized by dynamic programming approach.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"So, we may \", React.createElement(_components.strong, null, \"save the energy of the current seam\"), \" at the particular pixel in an additional \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">seamsEnergies</code>\"\n    }\n  }), \" table to make it re-usable for calculating the next seams faster (the \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">seamsEnergies</code>\"\n    }\n  }), \" table will have the same size as the energy map and the image itself).\"), \"\\n\", React.createElement(_components.p, null, \"Let's also keep in mind that for one particular pixel on the image (i.e. the bottom left one) we may have \", React.createElement(_components.em, null, \"several\"), \" values of the previous seams energies.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 34.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABXklEQVR42m2RXU/iQBSG+f9/wwsvzCYbLzZ6gRYJ7VJKhVpLWxBDUNElLmvajHa+nk1b0Qt9k5MzmWSe875nOtZaav25eWJ6MSZLE2ZpSjKbobVGS9X29wLD3eMtWTZlns9JkoT1es1enT0wjR44/dknngRMo4jh8DdSSmSlUUo1JaUCNL3LnIHXI76KGAUj4jj+CrwOl/w4OMbrO5ydO3S7XZRUVG+yBUtJVckG6EchA/cX42CE4zgfwDpBxxrTAoc5p4cnXIYjgvEY13XfHaqmK9VW/SgIffreEb7v0etdMJlMGoYx5tPhze2WgTslz1MWi0Wzm3ZvBqlMezaG2sC5l+EHIfN5xnWSsFwuPyPr3Q4hBPebB9b3d82lMqaZVkOs1VhVgnlFv+0oy4LVasXf3b+PmHtT7Q6LAv3yQrndIp6f4VWAEGgh2Gw2qKoEq8AarJbN5xRFQVVVfKf/lqwMw8TKK+YAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"What seam to choose\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/f805b7860e06cc3729fb21f6adf1f571/00d43/53-dp-what-to-choose.png\\\"\\n        srcset=\\\"/static/f805b7860e06cc3729fb21f6adf1f571/63868/53-dp-what-to-choose.png 250w,\\n/static/f805b7860e06cc3729fb21f6adf1f571/0b533/53-dp-what-to-choose.png 500w,\\n/static/f805b7860e06cc3729fb21f6adf1f571/00d43/53-dp-what-to-choose.png 1000w,\\n/static/f805b7860e06cc3729fb21f6adf1f571/aa440/53-dp-what-to-choose.png 1500w,\\n/static/f805b7860e06cc3729fb21f6adf1f571/e8950/53-dp-what-to-choose.png 2000w,\\n/static/f805b7860e06cc3729fb21f6adf1f571/821da/53-dp-what-to-choose.png 2200w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Since we're looking for a seam with the lowest resulting energy it would make sense to pick the previous seam with the lowest resulting energy as well.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 53.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACHElEQVR42nWTUW/aMBSF8yf2V/Zf97jHPa/rA+qqCmhLU5pBgNCVDAimBMcJhIQ4QGKf6ZpqUqfN0tG5lqOTL/c6lpQSy+USi8UCYRiiKApTCyHwr7WXW+zLFMdTCXnIzD4rEl2ecihVc4sxBt/34bouut0uptMpRqMRhsMhsiwzIVpr44eTRLAewn91wKJnLMVPzEIXL8zWLPLoBdzyPA/9fh9PT0/o9Xp/3LZtQ05LKWV8txcQ6RJRyhBtA4iUQWypZnqThdhmnFuDwQCO46DT6eD29tZQ0r7ZbBravwOJbME9sGhsasbHCNaeXiUTbLM1t4iOQu7u7owTIdFR+Hw+fx9YxOCbOdabmREnT6YI4186TtmZ8ObmBldXV7i8vESr1cL19TUuLi7QaDQQBME5sK6NpzlHEA4xXw2JCkw8YxGNidgQboiQiNrttiGjQCKlNlDwbDZ7Rxina3zvfEOj+QVt5yuIiieGUie7N0IKur+/N59JTv2jobSaTbC3oVTpFmARNqGNH52PGNufMF29YJ34CGMfq3iio3R+Duw5Dro0WdeF/fBg6NzBAA+Pj3idTIAkQV3sgQOQ7foYex+wWH1GlAqE8YT6h1Xsa5EG2BWCW1VZ4hiGOEmJSimclMJRShw5R50k7y51rSrkZYJjJVHVR1TqrFN90Bo1lFbcApCjLHMlhBGEyGtyKXM6U0oZmef+L/oDCgDT3yXeKAIOACqjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Seams energies example\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/7d3ec9d93e7004ff13315a22dd1fabde/00d43/56-dp-seams-energies-example.png\\\"\\n        srcset=\\\"/static/7d3ec9d93e7004ff13315a22dd1fabde/63868/56-dp-seams-energies-example.png 250w,\\n/static/7d3ec9d93e7004ff13315a22dd1fabde/0b533/56-dp-seams-energies-example.png 500w,\\n/static/7d3ec9d93e7004ff13315a22dd1fabde/00d43/56-dp-seams-energies-example.png 1000w,\\n/static/7d3ec9d93e7004ff13315a22dd1fabde/7a1fb/56-dp-seams-energies-example.png 1030w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"In general, we have three possible previous seems to choose from:\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 811px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 64.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB80lEQVR42pWSXW/TMBiF94/4W/wbRKHtgN1NCAmB4G4gLrhDqqZKo1LXrmmdNl9NHMf5cJyP1vFBTTuJwVjHkV4fybIfn9f2Ce5It2MqQ/gRQRAvkUqGNGcI+BI0XsFjc0Spiz/UHNw4wT2qNwUyGSEvE1S1RL0pUdY5MsmQiACyTP8fmBccSm1RbQqIgqPeli2oqAVkmdzp6EFgtZHwuYl1tIAbzmDTCcLEgk2v4UVzOOEUHpu1h7RIrR8G0sSGH5lIRAiPLWAFM4hcYOXNEHIfa2qBxQFY4h0D7uMLGcGmN1gzExYdY/hzgFe9HnqnffT7p+j2e+h2nsNckn2vTXMEWPA2YZwFCGKC0XiEi/NzvOu/xMfuM3x40cH7szdYmOYx4F5x5sNjBljiwKFTEGeEmOf4dtHB6+4TDH98ghcECLnzuDvcJbSCSQsl3hUM5xKJ9PFl8Badz08xmHzFmi/AUvtxQJY6bbqiEohSp/3M9bYCjS3IIm2vIisixMK/H6i1VrcFQAnJ1cq/Vm5oqIV7pQx7qAK+UjfWpVr5Y0W8kbKCiQoTp13fNM3ONwfg9K9H4cIDyyyUmwSRsEBTE9umAE0IRBkizt29/yshAPJ7qUaRMHWIHxHisTlxQ4NQbrV+O7dzWaWHPc3O51prV2v9/Rd9Mdf5zl4a0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Three options to choose from\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/964dfeb619cb26f3c62eec93a6602a9e/fd28b/55-dp-three-options.png\\\"\\n        srcset=\\\"/static/964dfeb619cb26f3c62eec93a6602a9e/63868/55-dp-three-options.png 250w,\\n/static/964dfeb619cb26f3c62eec93a6602a9e/0b533/55-dp-three-options.png 500w,\\n/static/964dfeb619cb26f3c62eec93a6602a9e/fd28b/55-dp-three-options.png 811w\\\"\\n        sizes=\\\"(max-width: 811px) 100vw, 811px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"You may think about it this way:\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"The cell \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[1][x]</code>\"\n    }\n  }), \": contains the lowest possible energy of the seam that starts somewhere on the row \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[0][?]</code>\"\n    }\n  }), \" and ends up at cell \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[1][x]</code>\"\n    }\n  })), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"The current cell\"), \" \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[2][3]</code>\"\n    }\n  }), \": contains the lowest possible energy of the seam that starts somewhere on the row \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[0][?]</code>\"\n    }\n  }), \" and ends up at cell \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[2][3]</code>\"\n    }\n  }), \". To calculate it we need to sum up the energy of the current pixel \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">[2][3]</code>\"\n    }\n  }), \" (from the energy map) with the \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">min(seam_energy_1_2, seam_energy_1_3, seam_energy_1_4)</code>\"\n    }\n  })), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"If we fill the \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">seamsEnergies</code>\"\n    }\n  }), \" table completely, then the minimum number in the lowest row would be the lowest possible seam energy.\"), \"\\n\", React.createElement(_components.p, null, \"Let's try to fill several cells of this table to see how it works.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 40.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABp0lEQVR42oWRW4/TMBCF+/f5CfDCH1ieVkK8t6po0rLZ7LbFTbNNnMRNL/SSi+M6npxVzAJCQmKkM5Y8mk8+x4MsyxAEAaIoQpam6Eu3Cs2twk1LXKq9Pf9T1Leu6/jA9304joPpdIqZ68IUJeStxLnMUVRHGDKomyvO1y3O5Q5E5jdFaWlnUpV/gOPxGL1GoxEcxwXVNSLh43kzxIvwUMorkvQJy3CEZTxGUZ2ADrhphRV38eR/xkvmWSAR8UEPGg6HFjqZTGCMQZTPwbiLZM9wPO2Q7lYIMw/fIwepiEGmQ1FeEWaPYJGDaDsn07b9Lh+kaYokSSCEsOo6wrU+4EchrOXWaFTNxdo9XDLUsvgZGhnszzHEcY39mdsXGjJ88K+E89MG69hBki/sB73lg+0xRJC4iPNn6LZ5A7fgeUAbcY+Qf/ob2C9JKRFmD/Ae7xGJBxT1BVq39n6VuJitvoAlX3EpTjAtoa4rLOMJzdk7eOyjBapfIoLSWiueL1SQTpU4rFXdlIoMqbbVivGZ+sbuFON3qm4aBSKlblItIkd67D189mH9CouAVYl6gNKLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Seams energies map traversal\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/1e0976acfa19931abe904d6971291f27/00d43/57-dp-seams-energies-traversal.png\\\"\\n        srcset=\\\"/static/1e0976acfa19931abe904d6971291f27/63868/57-dp-seams-energies-traversal.png 250w,\\n/static/1e0976acfa19931abe904d6971291f27/0b533/57-dp-seams-energies-traversal.png 500w,\\n/static/1e0976acfa19931abe904d6971291f27/00d43/57-dp-seams-energies-traversal.png 1000w,\\n/static/1e0976acfa19931abe904d6971291f27/aa440/57-dp-seams-energies-traversal.png 1500w,\\n/static/1e0976acfa19931abe904d6971291f27/17009/57-dp-seams-energies-traversal.png 1932w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"After filling out the \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">seamsEnergies</code>\"\n    }\n  }), \" table we may see that the lowest energy pixel has an energy of \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">50</code>\"\n    }\n  }), \". For convenience, during the \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">seamsEnergies</code>\"\n    }\n  }), \" generation for each pixel, we may save not only the energy of the seam but also the coordinates of the previous lowest energy seam. This will give us the possibility to reconstruct the seam path from the bottom to the top easily.\"), \"\\n\", React.createElement(_components.p, null, \"The time complexity of DP approach would be \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">O(w * h)</code>\"\n    }\n  }), \", where \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">w</code>\"\n    }\n  }), \" and \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">h</code>\"\n    }\n  }), \" are the width and the height of the image. We need to calculate energies for \", React.createElement(_components.em, null, \"every\"), \" pixel of the image.\"), \"\\n\", React.createElement(_components.p, null, \"Here is an example of how this logic might be implemented:\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"typescript\\\"><pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// The metadata for the pixels in the seam.</span>\\n<span class=\\\"token keyword\\\">type</span> <span class=\\\"token class-name\\\">SeamPixelMeta</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  energy<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// The energy of the pixel.</span>\\n  coordinate<span class=\\\"token operator\\\">:</span> Coordinate<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// The coordinate of the pixel.</span>\\n  previous<span class=\\\"token operator\\\">:</span> Coordinate <span class=\\\"token operator\\\">|</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">// The previous pixel in a seam.</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">// Finds the seam (the sequence of pixels from top to bottom) that has the</span>\\n<span class=\\\"token comment\\\">// lowest resulting energy using the Dynamic Programming approach.</span>\\n<span class=\\\"token keyword\\\">const</span> findLowEnergySeam <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>energyMap<span class=\\\"token operator\\\">:</span> EnergyMap<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> w<span class=\\\"token punctuation\\\">,</span> h <span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">:</span> ImageSize<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> Seam <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token comment\\\">// The 2D array of the size of w and h, where each pixel contains the</span>\\n  <span class=\\\"token comment\\\">// seam metadata (pixel energy, pixel coordinate and previous pixel from</span>\\n  <span class=\\\"token comment\\\">// the lowest energy seam at this point).</span>\\n  <span class=\\\"token keyword\\\">const</span> seamsEnergies<span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">(</span>SeamPixelMeta <span class=\\\"token operator\\\">|</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token generic-function\\\"><span class=\\\"token function\\\">matrix</span><span class=\\\"token generic class-name\\\"><span class=\\\"token operator\\\">&lt;</span>SeamPixelMeta <span class=\\\"token operator\\\">|</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token operator\\\">></span></span></span><span class=\\\"token punctuation\\\">(</span>w<span class=\\\"token punctuation\\\">,</span> h<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token comment\\\">// Populate the first row of the map by just copying the energies</span>\\n  <span class=\\\"token comment\\\">// from the energy map.</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> x <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">&lt;</span> w<span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> y <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span>\\n    seamsEnergies<span class=\\\"token punctuation\\\">[</span>y<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>x<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n      energy<span class=\\\"token operator\\\">:</span> energyMap<span class=\\\"token punctuation\\\">[</span>y<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>x<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n      coordinate<span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token punctuation\\\">,</span> y <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n      previous<span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token comment\\\">// Populate the rest of the rows.</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> y <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span> y <span class=\\\"token operator\\\">&lt;</span> h<span class=\\\"token punctuation\\\">;</span> y <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> x <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">&lt;</span> w<span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token comment\\\">// Find the top adjacent cell with minimum energy.</span>\\n      <span class=\\\"token comment\\\">// This cell would be the tail of a seam with lowest energy at this point.</span>\\n      <span class=\\\"token comment\\\">// It doesn't mean that this seam (path) has lowest energy globally.</span>\\n      <span class=\\\"token comment\\\">// Instead, it means that we found a path with the lowest energy that may lead</span>\\n      <span class=\\\"token comment\\\">// us to the current pixel with the coordinates x and y.</span>\\n      <span class=\\\"token keyword\\\">let</span> minPrevEnergy <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">Infinity</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">let</span> minPrevX<span class=\\\"token operator\\\">:</span> <span class=\\\"token builtin\\\">number</span> <span class=\\\"token operator\\\">=</span> x<span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> i <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;=</span> <span class=\\\"token punctuation\\\">(</span>x <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token operator\\\">>=</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">&amp;&amp;</span> i <span class=\\\"token operator\\\">&lt;</span> w <span class=\\\"token operator\\\">&amp;&amp;</span> seamsEnergies<span class=\\\"token punctuation\\\">[</span>y <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>energy <span class=\\\"token operator\\\">&lt;</span> minPrevEnergy<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n          minPrevEnergy <span class=\\\"token operator\\\">=</span> seamsEnergies<span class=\\\"token punctuation\\\">[</span>y <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>energy<span class=\\\"token punctuation\\\">;</span>\\n          minPrevX <span class=\\\"token operator\\\">=</span> i<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n\\n      <span class=\\\"token comment\\\">// Update the current cell.</span>\\n      seamsEnergies<span class=\\\"token punctuation\\\">[</span>y<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>x<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        energy<span class=\\\"token operator\\\">:</span> minPrevEnergy <span class=\\\"token operator\\\">+</span> energyMap<span class=\\\"token punctuation\\\">[</span>y<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>x<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n        coordinate<span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token punctuation\\\">,</span> y <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n        previous<span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token operator\\\">:</span> minPrevX<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token operator\\\">:</span> y <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token comment\\\">// Find where the minimum energy seam ends.</span>\\n  <span class=\\\"token comment\\\">// We need to find the tail of the lowest energy seam to start</span>\\n  <span class=\\\"token comment\\\">// traversing it from its tail to its head (from the bottom to the top).</span>\\n  <span class=\\\"token keyword\\\">let</span> lastMinCoordinate<span class=\\\"token operator\\\">:</span> Coordinate <span class=\\\"token operator\\\">|</span> <span class=\\\"token keyword\\\">null</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">let</span> minSeamEnergy <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">Infinity</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> x <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">&lt;</span> w<span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> y <span class=\\\"token operator\\\">=</span> h <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>seamsEnergies<span class=\\\"token punctuation\\\">[</span>y<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>x<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>energy <span class=\\\"token operator\\\">&lt;</span> minSeamEnergy<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      minSeamEnergy <span class=\\\"token operator\\\">=</span> seamsEnergies<span class=\\\"token punctuation\\\">[</span>y<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>x<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>energy<span class=\\\"token punctuation\\\">;</span>\\n      lastMinCoordinate <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token punctuation\\\">,</span> y <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token comment\\\">// Find the lowest energy energy seam.</span>\\n  <span class=\\\"token comment\\\">// Once we know where the tail is we may traverse and assemble the lowest</span>\\n  <span class=\\\"token comment\\\">// energy seam based on the \\\"previous\\\" value of the seam pixel metadata.</span>\\n  <span class=\\\"token keyword\\\">const</span> seam<span class=\\\"token operator\\\">:</span> Seam <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>lastMinCoordinate<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> seam<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token operator\\\">:</span> lastMinX<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token operator\\\">:</span> lastMinY <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">=</span> lastMinCoordinate<span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token comment\\\">// Adding new pixel to the seam path one by one until we reach the top.</span>\\n  <span class=\\\"token keyword\\\">let</span> currentSeam <span class=\\\"token operator\\\">=</span> seamsEnergies<span class=\\\"token punctuation\\\">[</span>lastMinY<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>lastMinX<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">while</span> <span class=\\\"token punctuation\\\">(</span>currentSeam<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    seam<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">push</span><span class=\\\"token punctuation\\\">(</span>currentSeam<span class=\\\"token punctuation\\\">.</span>coordinate<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">const</span> prevMinCoordinates <span class=\\\"token operator\\\">=</span> currentSeam<span class=\\\"token punctuation\\\">.</span>previous<span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>prevMinCoordinates<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      currentSeam <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">const</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token operator\\\">:</span> prevMinX<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token operator\\\">:</span> prevMinY <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token operator\\\">=</span> prevMinCoordinates<span class=\\\"token punctuation\\\">;</span>\\n      currentSeam <span class=\\\"token operator\\\">=</span> seamsEnergies<span class=\\\"token punctuation\\\">[</span>prevMinY<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>prevMinX<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> seam<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.h3, {\n    id: \"removing-the-seam-with-the-lowest-energy\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Removing the seam with the lowest energy\", React.createElement(_components.a, {\n    href: \"#removing-the-seam-with-the-lowest-energy\",\n    \"aria-label\": \"removing the seam with the lowest energy permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"Once we found the lowest energy seam, we need to remove (to carve) the pixels that form it from the image. The removal is happening by shifting the pixels to the right of the seam by \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">1px</code>\"\n    }\n  }), \" to the left. For performance reasons, we don't actually delete the last columns. Instead, the rendering component will just ignore the part of the image that lays beyond the resized image width.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \\\"\\n    >\\n      <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 43.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdElEQVR42pWSWW/TUBCF88cRpE0jIcL2Z4rgAUiTuBE0LCqlquIt9s3i3U5bcx3b90OJVVrEQ8uRztzRHenTGWlaAEopyk2B73nEUUgUBoRBQFWV/JECqrpxUaFk2fRKcVetbUmzjPOpjjFz0W0HY+ZgOC4XukmUpOS/JHmYoa4KyDeo8BrlX6HWEnUpUZlEFeUt0PASng5teuM5vbHg2Vjw/NOCbt/k8NTm69mckwtBsdk0YWvVJLtxWUOt7gD9lL0jm44mONAEnZFLV5vz5KPJmzOX7+crTuwVsiga4N9b/ruy4Sfs9y0ORu7OnaFDVxO0Pxi8/Sn4tsz4Ynu3QO4B6n7K475Fe+CyN3RpDxz2R4JH73UOf7hM3JjP5n8kNL2Y3tGUl5rNq62PLV6PZ7wYTHl3ajGxVkwM8XBgnucsFnPW64wkjgmCYHc+2zcKQ9I0ZblcUtc196l101RVtbtHKSWe55EkCVEUEcfx7n87f4h+A4lwpCpIh5dpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Deleting the seam\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/2103d1bbc4099e8ef918e22cf84b52d8/00d43/60-deleting-example.png\\\"\\n        srcset=\\\"/static/2103d1bbc4099e8ef918e22cf84b52d8/63868/60-deleting-example.png 250w,\\n/static/2103d1bbc4099e8ef918e22cf84b52d8/0b533/60-deleting-example.png 500w,\\n/static/2103d1bbc4099e8ef918e22cf84b52d8/00d43/60-deleting-example.png 1000w,\\n/static/2103d1bbc4099e8ef918e22cf84b52d8/aa440/60-deleting-example.png 1500w,\\n/static/2103d1bbc4099e8ef918e22cf84b52d8/c4842/60-deleting-example.png 1634w\\\"\\n        sizes=\\\"(max-width: 1000px) 100vw, 1000px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"typescript\\\"><pre class=\\\"language-typescript\\\"><code class=\\\"language-typescript\\\"><span class=\\\"token comment\\\">// Deletes the seam from the image data.</span>\\n<span class=\\\"token comment\\\">// We delete the pixel in each row and then shift the rest of the row pixels to the left.</span>\\n<span class=\\\"token keyword\\\">const</span> deleteSeam <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token operator\\\">:</span> ImageData<span class=\\\"token punctuation\\\">,</span> seam<span class=\\\"token operator\\\">:</span> Seam<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> w <span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">:</span> ImageSize<span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  seam<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">forEach</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token operator\\\">:</span> seamX<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token operator\\\">:</span> seamY <span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">:</span> Coordinate<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> x <span class=\\\"token operator\\\">=</span> seamX<span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token punctuation\\\">(</span>w <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> x <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">const</span> nextPixel <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getPixel</span><span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token operator\\\">:</span> x <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token operator\\\">:</span> seamY <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token function\\\">setPixel</span><span class=\\\"token punctuation\\\">(</span>img<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> x<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token operator\\\">:</span> seamY <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> nextPixel<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.h2, {\n    id: \"objects-removal-1\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Objects removal\", React.createElement(_components.a, {\n    href: \"#objects-removal-1\",\n    \"aria-label\": \"objects removal 1 permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"The Seam Carving algorithm tries to remove the seams which consist of low energy pixels first. We could leverage this fact and by assigning low energy to some pixels manually (i.e. by drawing on the image and masking out some areas of it) we could make the Seam Carving algorithm to do \", React.createElement(_components.em, null, \"objects removal\"), \" for us for free.\"), \"\\n\", React.createElement(_components.p, null, \"Currently, in \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">getPixelEnergy()</code>\"\n    }\n  }), \" function we were using only the \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">R</code>\"\n    }\n  }), \", \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">G</code>\"\n    }\n  }), \", \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">B</code>\"\n    }\n  }), \" color channels to calculate the pixel's energy. But there is also the \", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<code class=\\\"language-text\\\">A</code>\"\n    }\n  }), \" (alpha, transparency) parameter of the color that we didn't use yet. We may use the transparency channel to tell the algorithm that transparent pixels are the pixels we want to remove. You may check the \", React.createElement(_components.a, {\n    href: \"https://github.com/trekhleb/js-image-carver/blob/main/src/utils/contentAwareResizer.ts#L54\"\n  }, \"source-code of the energy function\"), \" that takes transparency into account.\"), \"\\n\", React.createElement(_components.p, null, \"Here is how the algorithm works for object removal.\"), \"\\n\", React.createElement(_components.img, {\n    src: \"/posts-assets/b66335eb43b5d66231bd4025a043e0c0/10-demo-02.gif\",\n    alt: \"JS IMAGE CARVER OBJECT REMOVAL DEMO\"\n  }), \"\\n\", React.createElement(_components.h2, {\n    id: \"issues-and-whats-next\",\n    style: {\n      position: \"relative\"\n    }\n  }, \"Issues and what's next\", React.createElement(_components.a, {\n    href: \"#issues-and-whats-next\",\n    \"aria-label\": \"issues and whats next permalink\",\n    className: \"gatsby-remark-autolink-header-anchor after\"\n  }, React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  }))), \"\\n\", React.createElement(_components.p, null, \"The \", React.createElement(_components.a, {\n    href: \"https://github.com/trekhleb/js-image-carver\"\n  }, \"JS IMAGE CARVER\"), \" web app is far from being a production ready resizer of course. Its main purpose was to experiment with the Seam Carving algorithm interactively. So the plan for the future is to continue experimentation.\"), \"\\n\", React.createElement(_components.p, null, \"The \", React.createElement(_components.a, {\n    href: \"https://perso.crans.org/frenoy/matlab2012/seamcarving.pdf\"\n  }, \"original paper\"), \" describes how the Seam Carving algorithm might be used not only for the downscaling but also for the \", React.createElement(_components.strong, null, \"upscaling of the images\"), \". The upscaling, in turn, might be used to \", React.createElement(_components.strong, null, \"upscale the image back to its original width after the objects' removal\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Another interesting area of experimentation might be to make the algorithm work in a \", React.createElement(_components.strong, null, \"real-time\"), \".\"), \"\\n\", React.createElement(_components.blockquote, null, \"\\n\", React.createElement(_components.p, null, \"Those are the plans for the future, but for now, I hope that the example with image downsizing was interesting and useful for you. I also hope that you've got the idea of using dynamic programming to implement it.\"), \"\\n\", React.createElement(_components.p, null, \"So, good luck with your own experiments!\"), \"\\n\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import GATSBY_COMPILED_MDX from \"/home/runner/work/trekhleb.github.io/trekhleb.github.io/src/posts/2021/content-aware-image-resizing-in-javascript/index.mdx\";\nimport * as React from 'react';\nimport PostScreen from '../components/screens/PostScreen';\nconst query = \"3821838164\";\nconst BlogPost = props => {\n  const {data, children} = props;\n  return React.createElement(PostScreen, {\n    post: data\n  }, children);\n};\nBlogPost\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(BlogPost, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\n","import React from 'react';\nimport { FiCalendar } from '@react-icons/all-files/fi/FiCalendar';\nimport { FiClock } from '@react-icons/all-files/fi/FiClock';\n\nimport { PostTemplateQuery } from '../../templates/__generated__/PostTemplateQuery';\nimport PageHeader from '../shared/PageHeader';\nimport Row from '../shared/Row';\nimport { timeToReadFromRemark } from '../../utils/time';\nimport ErrorBoundary from '../shared/ErrorBoundary';\n\ntype PostProps = {\n  post: PostTemplateQuery,\n  children: React.ReactNode,\n};\n\nconst Post = (props: PostProps): React.ReactElement | null => {\n  const { post, children } = props;\n\n  const dateElement = post?.mdx?.frontmatter?.date ? (\n    <Row className=\"mr-6 mb-6 text-gray-500 text-sm\">\n      <FiCalendar className=\"mr-1\" />\n      {post?.mdx?.frontmatter.date}\n    </Row>\n  ) : null;\n\n  const timeToRead = post?.mdx?.timeToRead ? (\n    <Row>\n      <FiClock className=\"mr-1\" />\n      {timeToReadFromRemark(post?.mdx?.timeToRead)} min to read\n    </Row>\n  ) : null;\n\n  // To style the blog post the tailwindcss-typography plugin is used.\n  // @see: https://github.com/tailwindlabs/tailwindcss-typography\n  return (\n    <div className=\"flex flex-col items-center\">\n      <article className=\"w-full prose prose-sm sm:prose overflow-hidden prose-red\" style={{ maxWidth: '860px' }}>\n        <PageHeader>{post.mdx?.frontmatter?.title || ''}</PageHeader>\n        <Row>\n          {dateElement}\n          {timeToRead}\n        </Row>\n        <ErrorBoundary>\n          {children}\n        </ErrorBoundary>\n      </article>\n    </div>\n  );\n};\n\nexport default Post;\n","import React from 'react';\n\nimport PageLayout from '../layouts/PageLayout';\nimport { PostTemplateQuery } from '../../templates/__generated__/PostTemplateQuery';\nimport Post from '../elements/Post';\nimport SEO, { ogTypeArticle, titleModeSuffix } from '../shared/SEO';\nimport SubscriptionForm from '../shared/SubscriptionForm';\nimport ErrorBoundary from '../shared/ErrorBoundary';\n\ntype PostScreenProps = {\n  post: PostTemplateQuery;\n  children: React.ReactNode;\n};\n\nconst PostScreen = (props: PostScreenProps): React.ReactElement => {\n  const { post, children } = props;\n\n  return (\n    <PageLayout>\n      <SEO\n        title={post.mdx?.frontmatter?.title || ''}\n        titleMode={titleModeSuffix}\n        description={post.mdx?.frontmatter?.summary || ''}\n        image={post.mdx?.frontmatter?.cover?.childImageSharp?.gatsbyImageData?.images?.fallback?.src || ''}\n        type={ogTypeArticle}\n      />\n      <Post post={post}>{children}</Post>\n      <div className=\"flex flex-row justify-center items-center mt-16\">\n        <div className=\"max-w-md\">\n          <ErrorBoundary>\n            <SubscriptionForm />\n          </ErrorBoundary>\n        </div>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default PostScreen;\n","import React from 'react';\nimport { BsFillInfoCircleFill } from '@react-icons/all-files/bs/BsFillInfoCircleFill';\nimport { BiErrorCircle } from '@react-icons/all-files/bi/BiErrorCircle';\n\nimport Row from './Row';\n\ntype AlertType = 'error' | 'info';\n\ntype AlertProps = {\n  type: AlertType,\n  children: React.ReactNode | null,\n};\n\ntype alertIcons = Record<AlertType, React.ReactNode>;\n\ntype alertClasses = Record<AlertType, string>;\n\nexport const InfoAlert: AlertType = 'info';\nexport const ErrorAlert: AlertType = 'error';\n\nconst alertIcons: alertIcons = {\n  [InfoAlert]: <BsFillInfoCircleFill size={18} />,\n  [ErrorAlert]: <BiErrorCircle size={18} />,\n};\n\nconst alertClasses: alertClasses = {\n  [InfoAlert]: 'text-blue-600 bg-blue-100',\n  [ErrorAlert]: 'text-red-600 bg-red-100',\n};\n\nconst Alert = (props: AlertProps): React.ReactElement | null => {\n  const { children, type } = props;\n\n  if (!children) {\n    return null;\n  }\n\n  return (\n    <div className={`py-3 px-4 rounded-md ${alertClasses[type]}`}>\n      <Row>\n        <div className=\"mr-3\">\n          {alertIcons[type]}\n        </div>\n        <div className=\"text-sm\">\n          {children}\n        </div>\n      </Row>\n    </div>\n  );\n};\n\nexport default Alert;\n","import React, { ErrorInfo } from 'react';\nimport Alert, { ErrorAlert } from './Alert';\n\ntype Props = {\n  children: React.ReactNode,\n};\n\ntype State = {\n  hasError: boolean,\n};\n\nclass ErrorBoundary extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n    };\n  }\n\n  static getDerivedStateFromError(): State {\n    // Update state so the next render will show the fallback UI.\n    return {\n      hasError: true,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    // You can also log the error to an error reporting service.\n    // eslint-disable-next-line no-console\n    console.error(error, errorInfo);\n    this.setState({ hasError: true });\n  }\n\n  render(): React.ReactNode {\n    const { children } = this.props;\n    const { hasError } = this.state;\n\n    if (hasError) {\n      // You can render any custom fallback UI\n      return (\n        <Alert type={ErrorAlert}>\n          Component has crashed\n        </Alert>\n      );\n    }\n\n    return children;\n  }\n}\n\nexport default ErrorBoundary;\n","import React from 'react';\nimport ErrorBoundary from './ErrorBoundary';\n\ntype InteractivePostAreaProps = {\n  children: React.ReactNode,\n  title?: string | null,\n  className?: string,\n};\n\nconst InteractivePostArea = (props: InteractivePostAreaProps): React.ReactElement | null => {\n  const { children, title, className = '' } = props;\n\n  if (!children) {\n    return null;\n  }\n\n  const titleElement = title ? (\n    <div className=\"text-xs font-light\">\n      {title}\n    </div>\n  ) : null;\n\n  return (\n    <ErrorBoundary>\n      {titleElement}\n      <div className={`p-6 border border-dashed border-gray-300 rounded-md overflow-hidden ${className}`}>\n        {children}\n      </div>\n    </ErrorBoundary>\n  );\n};\n\nexport default InteractivePostArea;\n","import React from 'react';\nimport H, { hLevel } from './H';\n\ntype PageHeaderProps = {\n  children: React.ReactNode,\n  className?: string,\n};\n\nconst PageHeader = (props: PageHeaderProps): React.ReactElement | null => {\n  const { children, className = '' } = props;\n\n  const commonClasses = 'mb-6 uppercase font-extrabold';\n\n  const classes = `${commonClasses} ${className}`;\n\n  return (\n    <H level={hLevel.h1} className={classes}>{children}</H>\n  );\n};\n\nexport default PageHeader;\n","import React from 'react';\n\ntype SubscriptionFormProps = {\n  withHeader?: boolean,\n};\n\nconst SubscriptionForm = (props: SubscriptionFormProps): React.ReactElement => {\n  const { withHeader = true } = props;\n\n  const formAction = 'https://dev.us1.list-manage.com/subscribe/post?u=7714f14ff32085c685da2cfaa&amp;id=53ffa81463';\n\n  const inputClass = 'border py-2 px-3 mb-3 rounded border-gray-300 border-solid appearance-none';\n\n  const header = withHeader ? (\n    <h1 className=\"text-grey-darkest uppercase font-bold text-xl mb-3\">\n      Subscribe to the Newsletter\n    </h1>\n  ) : null;\n\n  return (\n    <div className=\"bg-white rounded-md shadow-md p-8\">\n      {header}\n\n      <p className=\"text-sm mb-3\">\n        Get my latest posts and project updates by email\n      </p>\n\n      <form action={formAction} method=\"post\" className=\"flex flex-col\">\n        <input\n          placeholder=\"First Name\"\n          type=\"text\"\n          name=\"FNAME\"\n          className={inputClass}\n          required\n        />\n\n        <input\n          placeholder=\"Email\"\n          type=\"email\"\n          name=\"EMAIL\"\n          className={inputClass}\n          required\n        />\n\n        <div className=\"hidden\" aria-hidden=\"true\">\n          <input\n            type=\"text\"\n            name=\"b_7714f14ff32085c685da2cfaa_53ffa81463\"\n            tabIndex={-1}\n          />\n        </div>\n\n        <input\n          type=\"submit\"\n          value=\"Subscribe\"\n          className=\"transition duration-200 ease-in-out bg-black text-white py-2 px-3 rounded shadow-sm cursor-pointer hover:bg-gray-800\"\n        />\n      </form>\n    </div>\n  );\n};\n\nexport default SubscriptionForm;\n","// Adjusting the time to read.\n// gatsby-transformer-remark plugin relies on the 265 average words per minute.\n// @see: https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-transformer-remark/src/utils/time-to-read.js\nexport const timeToReadFromRemark = (\n  remarkTimeToRead?: number | null | undefined,\n): number | null => {\n  if (typeof remarkTimeToRead !== 'number') {\n    return null;\n  }\n  const timeToReadMultiplier = 1;\n  const minTimeToRead = 1;\n  return Math.ceil(remarkTimeToRead * timeToReadMultiplier) || minTimeToRead;\n};\n\nexport const wait = async (ms: number): Promise<void> => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n","/**\n * @typedef {import('react').ReactNode} ReactNode\n * @typedef {import('mdx/types.js').MDXComponents} Components\n *\n * @typedef Props\n *   Configuration.\n * @property {Components | MergeComponents | null | undefined} [components]\n *   Mapping of names for JSX components to React components.\n * @property {boolean | null | undefined} [disableParentContext=false]\n *   Turn off outer component context.\n * @property {ReactNode | null | undefined} [children]\n *   Children.\n *\n * @callback MergeComponents\n *   Custom merge function.\n * @param {Components} currentComponents\n *   Current components from the context.\n * @returns {Components}\n *   Merged components.\n */\n\nimport React from 'react'\n\n/**\n * @type {import('react').Context<Components>}\n * @deprecated\n *   This export is marked as a legacy feature.\n *   That means its no longer recommended for use as it might be removed\n *   in a future major release.\n *\n *   Please use `useMDXComponents` to get context based components and\n *   `MDXProvider` to set context based components instead.\n */\nexport const MDXContext = React.createContext({})\n\n/**\n * @param {import('react').ComponentType<any>} Component\n * @deprecated\n *   This export is marked as a legacy feature.\n *   That means its no longer recommended for use as it might be removed\n *   in a future major release.\n *\n *   Please use `useMDXComponents` to get context based components instead.\n */\nexport function withMDXComponents(Component) {\n  return boundMDXComponent\n\n  /**\n   * @param {Record<string, unknown> & {components?: Components | null | undefined}} props\n   * @returns {JSX.Element}\n   */\n  function boundMDXComponent(props) {\n    const allComponents = useMDXComponents(props.components)\n    return React.createElement(Component, {...props, allComponents})\n  }\n}\n\n/**\n * Get current components from the MDX Context.\n *\n * @param {Components | MergeComponents | null | undefined} [components]\n *   Additional components to use or a function that takes the current\n *   components and filters/merges/changes them.\n * @returns {Components}\n *   Current components.\n */\nexport function useMDXComponents(components) {\n  const contextComponents = React.useContext(MDXContext)\n\n  // Memoize to avoid unnecessary top-level context changes\n  return React.useMemo(() => {\n    // Custom merge via a function prop\n    if (typeof components === 'function') {\n      return components(contextComponents)\n    }\n\n    return {...contextComponents, ...components}\n  }, [contextComponents, components])\n}\n\n/** @type {Components} */\nconst emptyObject = {}\n\n/**\n * Provider for MDX context\n *\n * @param {Props} props\n * @returns {JSX.Element}\n */\nexport function MDXProvider({components, children, disableParentContext}) {\n  /** @type {Components} */\n  let allComponents\n\n  if (disableParentContext) {\n    allComponents =\n      typeof components === 'function'\n        ? components({})\n        : components || emptyObject\n  } else {\n    allComponents = useMDXComponents(components)\n  }\n\n  return React.createElement(\n    MDXContext.Provider,\n    {value: allComponents},\n    children\n  )\n}\n"],"names":["GenIcon","module","exports","props","getPixel","img","_ref","x","y","i","width","data","subarray","setPixel","_ref2","color","set","matrix","w","h","filler","Array","fill","map","getPixelEnergy","left","middle","right","mR","mG","mB","mA","lEnergy","lR","lG","lB","rEnergy","rR","rG","rB","Math","sqrt","max","maxColorDistance","getPixelEnergyH","getPixelEnergyV","_ref3","_ref4","top","bottom","calculateEnergyMapH","_ref5","energyMap","Infinity","calculateEnergyMapV","_ref6","reCalculateEnergyMapH","_ref7","seam","forEach","_ref8","seamX","seamY","reCalculateEnergyMapV","_ref9","_ref10","findLowEnergySeamH","_ref11","seamsMap","energy","coordinate","previous","minPrevEnergy","minPrevX","lastMinCoordinate","minSeamEnergy","lastMinX","lastMinY","currentSeam","push","prevMinCoordinates","prevMinX","prevMinY","findLowEnergySeamV","_ref12","minPrevY","deleteSeamH","_ref13","_ref14","nextPixel","deleteSeamV","_ref15","_ref16","resizeImage","async","toWidth","toHeight","onIteration","args","pxToRemoveH","pxToRemoveV","height","size","globalSteps","globalStep","onResizeIteration","onIterationImg","onIterationSize","onIterationArgs","step","steps","toSize","pxToRemove","Error","wait","resizeImageWidth","resizeImageHeight","normalizeEnergy","maxEnergy","maxNormalizedEnergy","floor","normalizeEnergyMap","getMaxEnergy","normalizedMap","className","canvasRef","useRef","useEffect","length","energyCanvas","current","energyCtx","getContext","imgData","getImageData","normalizedEnergyMap","norm","putImageData","React","ref","seams","seamsCanvas","seamsCtx","fillStyle","fillRect","BUTTON_KIND_PRIMARY","BUTTON_KIND_SECONDARY","children","onClick","disabled","title","startEnhancer","style","kind","classes","defaultClasses","separator","type","onSelect","accept","capture","multiple","icon","FaFileImage","disabledClasses","Button","padding","onChange","event","files","target","checkboxRef","onCheckboxChange","checked","progress","barStyle","min","ceil","transition","value","rest","Object","assign","defaultBackgroundColor","lineColor","lineWidth","lineJoin","backgroundColor","revision","onDrawEnd","onDrawEndCallback","isPainting","setIsPainting","useState","mousePosition","setMousePosition","getCoordinates","canvas","pageX","offsetLeft","pageY","offsetTop","startPaint","useCallback","coordinates","paint","newMousePosition","drawLine","originalMousePosition","context","strokeStyle","beginPath","moveTo","lineTo","closePath","stroke","exitPaint","addEventListener","removeEventListener","clearRect","touchAction","maxScale","withSeam","withEnergyMap","withCredentials","imgAuthor","setImgAuthor","imgAuthorURL","setImgAuthorURL","useNaturalSize","setUseNaturalSize","imageSrc","setImageSrc","defaultImgSrc","resizedImgSrc","setResizedImgSrc","setEnergyMap","originalImgSize","setOriginalImgSize","originalImgViewSize","setOriginalImgViewSize","workingImgSize","setWorkingImgSize","setSeams","isResizing","setIsResizing","setProgress","maskImgData","setMaskImgData","maskRevision","setMaskRevision","toWidthScale","setToWidthScale","toWidthScaleString","setToWidthScaleString","toHeightScale","setToHeightScale","toHeightScaleString","setToHeightScaleString","imgRef","onReset","nrgMap","ctx","srcImg","naturalWidth","naturalHeight","updateSize","window","imgAuthorLink","href","fontWeight","rel","marginTop","Seams","originalImageSizeText","maskControls","onClearMask","border","outline","MdLayersClear","mask","Mask","zIndex","originalImage","FadeIn","FaRegHandPointer","src","alt","margin","workingImageScrollableText","workingImageSizeText","workingImage","resultImageSizeText","resultImage","debugEnergyMap","EnergyMap","resizerControls","FileSelector","imageURL","URL","createObjectURL","onResize","ratio","drawImage","wRatio","hRatio","imgXYtoMaskXY","imgX","imgY","iR","iG","iB","iA","applyMask","then","onFinish","toBlob","blob","imgUrl","ImShrink2","Input","scale","parseInt","Checkbox","state","progressBar","Progress","_createMdxContent","_components","span","p","h2","a","em","ol","li","strong","h3","ul","blockquote","h4","_provideComponents","components","dangerouslySetInnerHTML","__html","id","position","InteractivePostArea","ImageResizer","wrapper","MDXLayout","BlogPost","PostScreen","post","GatsbyMDXWrapper","GATSBY_COMPILED_MDX","_post$mdx","_post$mdx$frontmatter","_post$mdx2","_post$mdx3","_post$mdx4","_post$mdx5","_post$mdx5$frontmatte","dateElement","mdx","frontmatter","date","Row","FiCalendar","timeToRead","FiClock","timeToReadFromRemark","maxWidth","PageHeader","ErrorBoundary","_post$mdx2$frontmatte","_post$mdx3$frontmatte","_post$mdx3$frontmatte2","_post$mdx3$frontmatte3","_post$mdx3$frontmatte4","_post$mdx3$frontmatte5","_post$mdx3$frontmatte6","PageLayout","SEO","titleMode","titleModeSuffix","description","summary","image","cover","childImageSharp","gatsbyImageData","images","fallback","ogTypeArticle","Post","SubscriptionForm","InfoAlert","ErrorAlert","alertIcons","BsFillInfoCircleFill","BiErrorCircle","alertClasses","_React$Component","_this","call","hasError","_inheritsLoose","getDerivedStateFromError","_proto","prototype","componentDidCatch","error","errorInfo","console","this","setState","render","Alert","titleElement","commonClasses","H","level","hLevel","withHeader","inputClass","header","action","method","placeholder","name","required","tabIndex","remarkTimeToRead","Promise","resolve","setTimeout","ms","MDXContext","useMDXComponents","contextComponents"],"sourceRoot":""}